<h2 mat-dialog-title>Exportar Proyectos</h2>

<mat-dialog-content>
  <div class="export-options">
    <mat-form-field appearance="outline">
      <mat-label>Formato de Exportación</mat-label>
      <mat-select [(ngModel)]="selectedFormat">
        <mat-option value="xlsx">Excel (.xlsx)</mat-option>
        <mat-option value="csv">CSV (.csv)</mat-option>
        <mat-option value="pdf">PDF (.pdf)</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Campos a Exportar</mat-label>
      <mat-select multiple [(ngModel)]="selectedFields">
        <mat-option value="nombre">Nombre</mat-option>
        <mat-option value="descripcion">Descripción</mat-option>
        <mat-option value="fechaInicio">Fecha de Inicio</mat-option>
        <mat-option value="fechaFin">Fecha de Fin</mat-option>
        <mat-option value="estado">Estado</mat-option>
        <mat-option value="presupuesto">Presupuesto</mat-option>
        <mat-option value="ubicacionGeografica">Ubicación</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-checkbox [(ngModel)]="includeStats">
      Incluir Estadísticas
    </mat-checkbox>
  </div>

  <div class="preview" *ngIf="selectedFields.length > 0">
    <h3>Vista Previa</h3>
    <table mat-table [dataSource]="previewData">
      <ng-container *ngFor="let field of selectedFields" [matColumnDef]="field">
        <th mat-header-cell *matHeaderCellDef>{{getFieldLabel(field)}}</th>
        <td mat-cell *matCellDef="let project">{{getFieldValue(project, field)}}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="selectedFields"></tr>
      <tr mat-row *matRowDef="let row; columns: selectedFields;"></tr>
    </table>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Cancelar</button>
  <button mat-raised-button color="primary" (click)="export()" [disabled]="selectedFields.length === 0">
    Exportar
  </button>
</mat-dialog-actions> 