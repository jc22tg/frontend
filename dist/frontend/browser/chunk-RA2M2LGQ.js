import{a as Ke,b as ke}from"./chunk-6PYCTC3W.js";import{b as si,c as Gi,d as Ui,e as Yi}from"./chunk-3DOLLXBG.js";import{a as ci,b as di,c as mi,d as pi}from"./chunk-HOQN2RTO.js";import{a as gi,b as fi}from"./chunk-YFTEGT7S.js";import{a as Oi,b as Ni,c as Ai,d as Pi,e as Ri,f as Fi,g as Li,h as $i,i as zi,j as Vi,k as Hi}from"./chunk-DIVOCDBU.js";import{a as Ze,b as qi}from"./chunk-ELOSELUF.js";import{m as Qi}from"./chunk-7JRIPI7N.js";import{A as Wi,b as he,f as an,g as kt,h as Tt,i as It,j as Dt,k as ji,l as Bi}from"./chunk-AXXRXZW7.js";import{a as ki,b as Ti,c as Ii,d as Di}from"./chunk-YKHY2KRM.js";import{a as Et}from"./chunk-PS45K6N5.js";import{a as Mt,b as Ci,d as Mi,f as Si,g as Ei}from"./chunk-JGNBERAY.js";import{a as wi}from"./chunk-Q2I2H6RZ.js";import{b as St}from"./chunk-SFSNZG2F.js";import{a as Z,b as K,c as X,e as yi,f as J,h as N}from"./chunk-GQNYZBS2.js";import{a as hi,b as le}from"./chunk-F5P253LU.js";import{a as xi}from"./chunk-PYE7UGMK.js";import{a as se,b as q}from"./chunk-D3FDFS7S.js";import{d as _i,j as bi}from"./chunk-RWQWO3EM.js";import{a as fe}from"./chunk-ULFK375Q.js";import{A as vi}from"./chunk-JO2MD4NL.js";import{a as w,b as M,c as li,i as Q,j as F,k as ui,n as O}from"./chunk-XJSBNB6N.js";import{v as L,w as R}from"./chunk-VH7SA6GK.js";import{D as ai,H as He,k as ni,m as ri,p as oi}from"./chunk-4PHUDKEH.js";import{d as ii,e as Ee,i as ae}from"./chunk-D4QL4JVC.js";import{$ as Ht,$a as l,$b as g,$c as C,A as Pe,Aa as v,B as Ft,Ba as qt,C as Lt,Cb as Xt,F as Re,Gb as i,Hb as o,Ib as _,Ja as A,Jb as Le,K as $t,Ka as Qt,Kb as $e,Lc as V,M as W,Mb as P,Mc as H,Na as Ge,Nc as D,O as zt,Ob as p,Pa as Zt,Pb as m,Q as Vt,Qb as _t,Rb as bt,Ta as Kt,Tc as qe,Ub as ze,Vb as xe,Vc as Se,Wb as we,Y as Fe,Yc as ti,Zb as U,_b as a,a as be,ac as x,ba as jt,bc as yt,ca as Bt,cc as Ct,db as S,dc as xt,ec as wt,f as ht,fa as Ce,g as z,h as Rt,hc as Me,ic as ge,id as Qe,ja as G,ka as We,kb as y,kc as Jt,lb as Ue,ma as Wt,mb as vt,mc as k,n as b,nc as ie,o as ye,oa as re,oc as Y,pa as B,qb as f,ra as Gt,s as te,sa as Ut,vc as ei,wb as Ye,xb as c,xc as Ve,ya as Yt,yb as oe,za as h,zb as E}from"./chunk-FG6FKNI4.js";import{a as pe,b as ue,f as on}from"./chunk-OXVY4BEJ.js";var Zi=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ue({type:r});static \u0275inj=We({imports:[Et,He,Et,He]})}return r})();var Te=class r{constructor(t){this.http=t}apiUrl=`${fe.apiUrl}/monitoring`;retryConfig={maxRetries:2,delayMs:1e3,excludeStatusCodes:[400,401,403,404]};getNetworkHealth(){return this.http.get(`${this.apiUrl}/health`).pipe(Fe({count:this.retryConfig.maxRetries,delay:(t,e)=>{if(t?.status&&this.retryConfig.excludeStatusCodes.includes(t.status))return ye(()=>t);console.log(`Reintentando petici\xF3n getNetworkHealth... (intento ${e} de ${this.retryConfig.maxRetries})`);let n=this.retryConfig.delayMs*Math.pow(2,e);return Pe(n)}}),Re(t=>(console.error("Error obteniendo salud de la red",t),b({healthPercentage:85,activeElementsCount:42,warningElementsCount:5,criticalElementsCount:2,timestamp:new Date().toISOString()}))))}getElementMetrics(t,e,n=10){let s={metricType:e,limit:n.toString()};return this.http.get(`${this.apiUrl}/elements/${t}/metrics`,{params:s}).pipe(Fe({count:this.retryConfig.maxRetries,delay:(d,u)=>{if(d?.status&&this.retryConfig.excludeStatusCodes.includes(d.status))return ye(()=>d);console.log(`Reintentando petici\xF3n getElementMetrics for ${t}... (intento ${u} de ${this.retryConfig.maxRetries})`);let I=this.retryConfig.delayMs*Math.pow(2,u);return Pe(I)}}),Re(d=>(console.error(`Error obteniendo m\xE9tricas para el elemento ${t}`,d),b([]))))}getNetworkMetrics(t,e="day"){if(fe.useMocks)return console.info(`[NetworkMonitoringService] Usando datos simulados para ${t}`),b(this.generateMockNetworkMetrics(t));let n={metricType:t,period:e};return this.http.get(`${this.apiUrl}/metrics`,{params:n}).pipe(Fe({count:this.retryConfig.maxRetries,delay:(s,d)=>{if(s?.status&&this.retryConfig.excludeStatusCodes.includes(s.status))return ye(()=>s);console.log(`Reintentando petici\xF3n getNetworkMetrics for ${t}... (intento ${d} de ${this.retryConfig.maxRetries})`);let u=this.retryConfig.delayMs*Math.pow(2,d);return Pe(u)}}),te(s=>!s||!s.metrics&&!Array.isArray(s.bandwidth)?(console.warn("Formato de respuesta inesperado:",s),{metrics:[],lastUpdated:new Date}):s.metrics?s:{metrics:s[t]||[],lastUpdated:s.lastUpdated||new Date}),Re(s=>(console.error("Error obteniendo m\xE9tricas de red",s),s.error instanceof SyntaxError&&s.error.message.includes("Unexpected token")&&console.warn("La API est\xE1 retornando HTML en lugar de JSON. Verificar el estado del servidor."),fe.useMocks?(console.info("[NetworkMonitoringService] Usando datos simulados despu\xE9s de error en API"),b(this.generateMockNetworkMetrics(t))):b({metrics:[],lastUpdated:new Date}))))}generateMockNetworkMetrics(t){let e=new Date,n=[];for(let s=0;s<24;s++){let d=new Date(e);d.setHours(e.getHours()-(24-s));let u,I=s<12?"down":"up",me=Math.random()>.7?I==="up"?"down":"up":I;switch(t){case"bandwidth":let ne=d.getHours(),_e=ne>=9&&ne<=18,Ne=_e?350:150,gt=_e?150:50;u=Math.floor(Ne+Math.random()*gt);break;case"latency":let ft=10,Be=40,Ae=Math.abs(12-d.getHours()%24)/12;u=ft+Be*Ae*(.5+Math.random()*.5),u=parseFloat(u.toFixed(1));break;case"packetLoss":u=Math.random()>.9?parseFloat((.5+Math.random()*1.5).toFixed(2)):parseFloat((Math.random()*.5).toFixed(2));break;case"errors":u=Math.random()>.85?Math.floor(Math.random()*10)+1:0;break;case"temperature":u=25+Math.random()*15,u=parseFloat(u.toFixed(1));break;default:u=Math.floor(Math.random()*100)}n.push({id:`mock-${t}-${s}`,timestamp:d.toISOString(),value:u,trend:me,elementId:"network"})}return{metrics:n,lastUpdated:e}}getConnectionsStatus(){return this.http.get(`${this.apiUrl}/connections`).pipe(Fe({count:this.retryConfig.maxRetries,delay:(t,e)=>{if(t?.status&&this.retryConfig.excludeStatusCodes.includes(t.status))return ye(()=>t);console.log(`Reintentando petici\xF3n getConnectionsStatus... (intento ${e} de ${this.retryConfig.maxRetries})`);let n=this.retryConfig.delayMs*Math.pow(2,e);return Pe(n)}}),Re(t=>(console.error("Error obteniendo estado de conexiones",t),fe.useMocks?b(this.generateMockConnectionStatus()):ye(()=>t))))}generateMockConnectionStatus(){return{connections:Array(15).fill(0).map((e,n)=>{let s=["active","warning","error","inactive"],d=s[Math.floor(Math.random()*s.length)];return{id:`mock-connection-${n}`,sourceId:`source-${n}`,targetId:`target-${n}`,status:d,lastUpdated:new Date().toISOString(),metrics:{bandwidth:Math.floor(Math.random()*1e3),latency:Math.floor(Math.random()*50),packetLoss:parseFloat((Math.random()*2).toFixed(2))}}}),lastUpdated:new Date().toISOString()}}static \u0275fac=function(e){return new(e||r)(re(Qe))};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var Xe=class r{constructor(t){this.networkMonitoringService=t}refreshInterval=6e4;networkHealth=0;networkHealthLabel="";networkHealthClass="";networkHealthColor="primary";activeCount=0;warningCount=0;criticalCount=0;ngOnInit(){this.refreshData()}refreshData(){this.networkMonitoringService.getNetworkHealth().subscribe(t=>{this.networkHealth=t.healthPercentage,this.activeCount=t.activeElementsCount,this.warningCount=t.warningElementsCount,this.criticalCount=t.criticalElementsCount,this.updateHealthStatus()})}updateHealthStatus(){this.networkHealth>=90?(this.networkHealthLabel="Buena",this.networkHealthClass="good",this.networkHealthColor="primary"):this.networkHealth>=70?(this.networkHealthLabel="Regular",this.networkHealthClass="warning",this.networkHealthColor="accent"):(this.networkHealthLabel="Cr\xEDtica",this.networkHealthClass="critical",this.networkHealthColor="warn")}static \u0275fac=function(e){return new(e||r)(S(Te))};static \u0275cmp=y({type:r,selectors:[["app-network-health-widget"]],inputs:{refreshInterval:"refreshInterval"},decls:43,vars:8,consts:[[1,"health-widget"],["mat-icon-button","",3,"click"],[1,"health-summary"],[1,"health-indicator",3,"ngClass"],[1,"health-score"],[1,"health-label"],["mode","determinate",3,"color","value"],[1,"status-summary"],[1,"status-item"],[1,"status-icon","active"],[1,"status-details"],[1,"status-value"],[1,"status-label"],[1,"status-icon","warning"],[1,"status-icon","critical"]],template:function(e,n){e&1&&(i(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Salud de la Red"),o(),i(4,"button",1),p("click",function(){return n.refreshData()}),i(5,"mat-icon"),a(6,"refresh"),o()()(),i(7,"mat-card-content")(8,"div",2)(9,"div",3)(10,"span",4),a(11),o(),i(12,"span",5),a(13),o()(),_(14,"mat-progress-bar",6),o(),i(15,"div",7)(16,"div",8)(17,"div",9)(18,"mat-icon"),a(19,"check_circle"),o()(),i(20,"div",10)(21,"span",11),a(22),o(),i(23,"span",12),a(24,"Activos"),o()()(),i(25,"div",8)(26,"div",13)(27,"mat-icon"),a(28,"warning"),o()(),i(29,"div",10)(30,"span",11),a(31),o(),i(32,"span",12),a(33,"Advertencias"),o()()(),i(34,"div",8)(35,"div",14)(36,"mat-icon"),a(37,"error"),o()(),i(38,"div",10)(39,"span",11),a(40),o(),i(41,"span",12),a(42,"Cr\xEDticos"),o()()()()()()),e&2&&(l(9),c("ngClass",n.networkHealthClass),l(2),x("",n.networkHealth,"%"),l(2),g(n.networkHealthLabel),l(),c("color",n.networkHealthColor)("value",n.networkHealth),l(8),g(n.activeCount),l(9),g(n.warningCount),l(9),g(n.criticalCount))},dependencies:[C,V,N,Z,X,J,K,M,w,O,Q,ke,Ke],styles:[".health-widget[_ngcontent-%COMP%]{height:100%}.health-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.health-indicator[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:10px}.health-score[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700}.health-label[_ngcontent-%COMP%]{font-size:1rem}.health-indicator.good[_ngcontent-%COMP%]{color:#4caf50}.health-indicator.warning[_ngcontent-%COMP%]{color:#ff9800}.health-indicator.critical[_ngcontent-%COMP%]{color:#f44336}.status-summary[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:20px}.status-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.status-icon[_ngcontent-%COMP%]{margin-bottom:5px}.status-icon.active[_ngcontent-%COMP%]{color:#4caf50}.status-icon.warning[_ngcontent-%COMP%]{color:#ff9800}.status-icon.critical[_ngcontent-%COMP%]{color:#f44336}.status-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}.status-label[_ngcontent-%COMP%]{font-size:.8rem}"]})};var cn=["mat-sort-header",""],dn=["*"];function mn(r,t){r&1&&(i(0,"div",2),qt(),i(1,"svg",3),_(2,"path",4),o()())}var Xi=new Wt("MAT_SORT_DEFAULT_OPTIONS"),je=(()=>{class r{_defaultOptions;_initializedStream=new Rt(1);sortables=new Map;_stateChanges=new ht;active;start="asc";get direction(){return this._direction}set direction(e){this._direction=e}_direction="";disableClear;disabled=!1;sortChange=new A;initialized=this._initializedStream;constructor(e){this._defaultOptions=e}register(e){this.sortables.set(e.id,e)}deregister(e){this.sortables.delete(e.id)}sort(e){this.active!=e.id?(this.active=e.id,this.direction=e.start?e.start:this.start):this.direction=this.getNextSortDirection(e),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(e){if(!e)return"";let n=e?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear,s=pn(e.start||this.start,n),d=s.indexOf(this.direction)+1;return d>=s.length&&(d=0),s[d]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}static \u0275fac=function(n){return new(n||r)(S(Xi,8))};static \u0275dir=vt({type:r,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",Ve],disabled:[2,"matSortDisabled","disabled",Ve]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[Yt]})}return r})();function pn(r,t){let e=["asc","desc"];return r=="desc"&&e.reverse(),t||e.push(""),e}var et=(()=>{class r{changes=new ht;static \u0275fac=function(n){return new(n||r)};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function un(r){return r||new et}var gn={provide:et,deps:[[new Gt,new Ut,et]],useFactory:un},Ji=(()=>{class r{_intl=B(et);_sort=B(je,{optional:!0});_columnDef=B("MAT_SORT_HEADER_COLUMN_DEF",{optional:!0});_changeDetectorRef=B(ei);_focusMonitor=B(ni);_elementRef=B(Ge);_ariaDescriber=B(ai,{optional:!0});_renderChanges;_animationModule=B(Kt,{optional:!0});_recentlyCleared=Zt(null);_sortButton;id;arrowPosition="after";start;disabled=!1;get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(e){this._updateSortActionDescription(e)}_sortActionDescription="Sort";disableClear;constructor(){B(ri).load(li);let e=B(Xi,{optional:!0});this._sort,e?.arrowPosition&&(this.arrowPosition=e?.arrowPosition)}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._sort.register(this),this._renderChanges=Lt(this._sort._stateChanges,this._sort.sortChange).subscribe(()=>this._changeDetectorRef.markForCheck()),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(()=>this._recentlyCleared.set(null))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._renderChanges?.unsubscribe(),this._sortButton&&this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription)}_toggleOnInteraction(){if(!this._isDisabled()){let e=this._isSorted(),n=this._sort.direction;this._sort.sort(this),this._recentlyCleared.set(e&&!this._isSorted()?n:null)}}_handleKeydown(e){(e.keyCode===32||e.keyCode===13)&&(e.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&(this._sort.direction==="asc"||this._sort.direction==="desc")}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?this._sort.direction=="asc"?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(e){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,e)),this._sortActionDescription=e}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=y({type:r,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(n,s){n&1&&p("click",function(){return s._toggleOnInteraction()})("keydown",function(u){return s._handleKeydown(u)})("mouseleave",function(){return s._recentlyCleared.set(null)}),n&2&&(Ye("aria-sort",s._getAriaSortAttribute()),E("mat-sort-header-disabled",s._isDisabled()))},inputs:{id:[0,"mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",disabled:[2,"disabled","disabled",Ve],sortActionDescription:"sortActionDescription",disableClear:[2,"disableClear","disableClear",Ve]},exportAs:["matSortHeader"],attrs:cn,ngContentSelectors:dn,decls:4,vars:17,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],[1,"mat-sort-header-arrow"],["viewBox","0 -960 960 960","focusable","false","aria-hidden","true"],["d","M440-240v-368L296-464l-56-56 240-240 240 240-56 56-144-144v368h-80Z"]],template:function(n,s){n&1&&(_t(),i(0,"div",0)(1,"div",1),bt(2),o(),f(3,mn,3,0,"div",2),o()),n&2&&(E("mat-sort-header-sorted",s._isSorted())("mat-sort-header-position-before",s.arrowPosition==="before")("mat-sort-header-descending",s._sort.direction==="desc")("mat-sort-header-ascending",s._sort.direction==="asc")("mat-sort-header-recently-cleared-ascending",s._recentlyCleared()==="asc")("mat-sort-header-recently-cleared-descending",s._recentlyCleared()==="desc")("mat-sort-header-animations-disabled",s._animationModule==="NoopAnimations"),Ye("tabindex",s._isDisabled()?null:0)("role",s._isDisabled()?null:"button"),l(3),Xt(s._renderArrow()?3:-1))},styles:[`.mat-sort-header{cursor:pointer}.mat-sort-header-disabled{cursor:default}.mat-sort-header-container{display:flex;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-sort-header-content{display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}@keyframes _mat-sort-header-recently-cleared-ascending{from{transform:translateY(0);opacity:1}to{transform:translateY(-25%);opacity:0}}@keyframes _mat-sort-header-recently-cleared-descending{from{transform:translateY(0) rotate(180deg);opacity:1}to{transform:translateY(25%) rotate(180deg);opacity:0}}.mat-sort-header-arrow{height:12px;width:12px;position:relative;transition:transform 225ms cubic-bezier(0.4, 0, 0.2, 1),opacity 225ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;overflow:visible;color:var(--mat-sort-arrow-color, var(--mat-sys-on-surface))}.mat-sort-header.cdk-keyboard-focused .mat-sort-header-arrow,.mat-sort-header.cdk-program-focused .mat-sort-header-arrow,.mat-sort-header:hover .mat-sort-header-arrow{opacity:.54}.mat-sort-header .mat-sort-header-sorted .mat-sort-header-arrow{opacity:1}.mat-sort-header-descending .mat-sort-header-arrow{transform:rotate(180deg)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transform:translateY(-25%)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-ascending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-recently-cleared-descending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-descending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-animations-disabled .mat-sort-header-arrow{transition-duration:0ms;animation-duration:0ms}.mat-sort-header-arrow svg{width:24px;height:24px;fill:currentColor;position:absolute;top:50%;left:50%;margin:-12px 0 0 -12px;transform:translateZ(0)}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}
`],encapsulation:2,changeDetection:0})}return r})(),en=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=Ue({type:r});static \u0275inj=We({providers:[gn],imports:[He]})}return r})();var hn=()=>[5,10,20];function vn(r,t){if(r&1&&(i(0,"mat-option",17),a(1),o()),r&2){let e=t.$implicit;c("value",e.id),l(),x(" ",e.name," ")}}function _n(r,t){if(r&1){let e=P();i(0,"mat-form-field",3)(1,"mat-label"),a(2,"Elemento"),o(),i(3,"mat-select",4),wt("valueChange",function(s){h(e);let d=m();return xt(d.selectedElementId,s)||(d.selectedElementId=s),v(s)}),p("selectionChange",function(){h(e);let s=m();return v(s.loadElementMetrics())}),i(4,"mat-option",15),a(5,"Todos los elementos"),o(),f(6,vn,2,2,"mat-option",16),o()()}if(r&2){let e=m();l(3),Ct("value",e.selectedElementId),l(3),c("ngForOf",e.elements)}}function bn(r,t){r&1&&(i(0,"th",29),a(1,"Elemento"),o())}function yn(r,t){if(r&1&&(i(0,"td",30),a(1),o()),r&2){let e=t.$implicit,n=m(3);l(),g(n.getElementName(e.elementId))}}function Cn(r,t){r&1&&(Le(0,28),f(1,bn,2,0,"th",21)(2,yn,2,1,"td",22),$e())}function xn(r,t){r&1&&(i(0,"th",29),a(1,"Fecha/Hora"),o())}function wn(r,t){if(r&1&&(i(0,"td",30),a(1),k(2,"date"),o()),r&2){let e=t.$implicit;l(),g(Y(2,1,e.timestamp,"short"))}}function Mn(r,t){r&1&&(i(0,"th",29),a(1,"Valor"),o())}function Sn(r,t){if(r&1&&(i(0,"td",30),a(1),o()),r&2){let e=t.$implicit,n=m(2);l(),g(n.formatMetricValue(e.value))}}function En(r,t){r&1&&(i(0,"th",31),a(1,"Tendencia"),o())}function kn(r,t){if(r&1&&(i(0,"td",30)(1,"mat-icon",32),a(2),o()()),r&2){let e=t.$implicit,n=m(2);l(),c("ngClass",n.getTrendClass(e.trend)),l(),g(n.getTrendIcon(e.trend))}}function Tn(r,t){r&1&&_(0,"tr",33)}function In(r,t){r&1&&_(0,"tr",34)}function Dn(r,t){if(r&1&&(i(0,"table",18),f(1,Cn,3,0,"ng-container",19),Le(2,20),f(3,xn,2,0,"th",21)(4,wn,3,4,"td",22),$e(),Le(5,23),f(6,Mn,2,0,"th",21)(7,Sn,2,1,"td",22),$e(),Le(8,24),f(9,En,2,0,"th",25)(10,kn,3,2,"td",22),$e(),f(11,Tn,1,0,"tr",26)(12,In,1,0,"tr",27),o()),r&2){let e=m();c("dataSource",e.metrics),l(),c("ngIf",e.showElementColumn),l(10),c("matHeaderRowDef",e.getDisplayedColumns()),l(),c("matRowDefColumns",e.getDisplayedColumns())}}function On(r,t){r&1&&(i(0,"div",35)(1,"mat-icon"),a(2,"info"),o(),i(3,"span"),a(4,"No hay datos disponibles para los filtros seleccionados"),o()())}function Nn(r,t){r&1&&_(0,"mat-paginator",36),r&2&&c("pageSizeOptions",Me(1,hn))}var tt=class r{constructor(t){this.networkMonitoringService=t}showElementSelector=!0;selectedElementId="";maxRows=10;paginator;sort;metrics=[];elements=[];selectedMetricType="bandwidth";showElementColumn=!0;ngOnInit(){this.loadElements(),this.refreshData()}refreshData(){this.selectedElementId?this.loadElementMetrics():this.loadNetworkMetrics()}onMetricTypeChange(t){this.selectedMetricType=t,this.refreshData()}loadElementMetrics(){this.selectedElementId&&(this.showElementColumn=!1,this.networkMonitoringService.getElementMetrics(this.selectedElementId,this.selectedMetricType,this.maxRows).subscribe(t=>{this.metrics=t}))}loadNetworkMetrics(){this.showElementColumn=!0,this.networkMonitoringService.getNetworkMetrics(this.selectedMetricType,"day").subscribe({next:t=>{t&&Array.isArray(t.metrics)?this.metrics=t.metrics.map((e,n,s)=>ue(pe({},e),{trend:this.calculateTrend(e,n>0?s[n-1]:null)})):(console.warn("Formato de datos inesperado:",t),this.metrics=[])},error:t=>{console.error("Error al cargar m\xE9tricas de red:",t),this.metrics=[]}})}calculateTrend(t,e){if(!e||e.value===void 0)return"stable";let n=t.value-e.value;return Math.abs(n)<.001?"stable":n>0?"up":"down"}loadElements(){this.elements=[{id:"olt1",name:"OLT Principal"},{id:"ont1",name:"ONT Cliente 1"},{id:"splitter1",name:"Splitter Zona Norte"}]}getElementName(t){let e=this.elements.find(n=>n.id===t);return e?e.name:t}getDisplayedColumns(){return this.showElementColumn?["element","timestamp","value","trend"]:["timestamp","value","trend"]}formatMetricValue(t){switch(this.selectedMetricType){case"bandwidth":return`${t} Mbps`;case"latency":return`${t} ms`;case"packetLoss":return`${t}%`;case"temperature":return`${t}\xB0C`;case"power":return`${t} dBm`;case"signal":return`${t} dB`;default:return`${t}`}}getTrendIcon(t){switch(t){case"up":return"trending_up";case"down":return"trending_down";case"stable":return"trending_flat";default:return"trending_flat"}}getTrendClass(t){switch(t){case"up":return"trend-up";case"down":return"trend-down";case"stable":return"trend-stable";default:return""}}static \u0275fac=function(e){return new(e||r)(S(Te))};static \u0275cmp=y({type:r,selectors:[["app-metrics-widget"]],viewQuery:function(e,n){if(e&1&&(ze(Ze,5),ze(je,5)),e&2){let s;xe(s=we())&&(n.paginator=s.first),xe(s=we())&&(n.sort=s.first)}},inputs:{showElementSelector:"showElementSelector",selectedElementId:"selectedElementId",maxRows:"maxRows"},decls:29,vars:5,consts:[[1,"metrics-widget"],["mat-icon-button","",3,"click"],[1,"filter-bar"],["appearance","outline"],[3,"valueChange","selectionChange","value"],["value","bandwidth"],["value","latency"],["value","packetLoss"],["value","temperature"],["value","power"],["value","signal"],["appearance","outline",4,"ngIf"],["mat-table","","matSort","","class","metrics-table",3,"dataSource",4,"ngIf"],["class","no-data-message",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions",4,"ngIf"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-table","","matSort","",1,"metrics-table",3,"dataSource"],["matColumnDef","element",4,"ngIf"],["matColumnDef","timestamp"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","value"],["matColumnDef","trend"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","element"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],[3,"ngClass"],["mat-header-row",""],["mat-row",""],[1,"no-data-message"],["showFirstLastButtons","",3,"pageSizeOptions"]],template:function(e,n){e&1&&(i(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),a(3,"M\xE9tricas de Red"),o(),i(4,"button",1),p("click",function(){return n.refreshData()}),i(5,"mat-icon"),a(6,"refresh"),o()()(),i(7,"mat-card-content")(8,"div",2)(9,"mat-form-field",3)(10,"mat-label"),a(11,"Tipo de M\xE9trica"),o(),i(12,"mat-select",4),wt("valueChange",function(d){return xt(n.selectedMetricType,d)||(n.selectedMetricType=d),d}),p("selectionChange",function(d){return n.onMetricTypeChange(d.value)}),i(13,"mat-option",5),a(14,"Ancho de Banda"),o(),i(15,"mat-option",6),a(16,"Latencia"),o(),i(17,"mat-option",7),a(18,"P\xE9rdida de Paquetes"),o(),i(19,"mat-option",8),a(20,"Temperatura"),o(),i(21,"mat-option",9),a(22,"Potencia"),o(),i(23,"mat-option",10),a(24,"Se\xF1al"),o()()(),f(25,_n,7,2,"mat-form-field",11),o(),f(26,Dn,13,4,"table",12)(27,On,5,0,"div",13)(28,Nn,1,2,"mat-paginator",14),o()()),e&2&&(l(12),Ct("value",n.selectedMetricType),l(13),c("ngIf",n.showElementSelector),l(),c("ngIf",n.metrics.length>0),l(),c("ngIf",n.metrics.length===0),l(),c("ngIf",n.metrics.length>0))},dependencies:[C,V,H,D,Se,N,Z,X,J,K,M,w,O,Q,Ei,bi,_i,Si,Mi,wi,vi,Hi,Oi,Ai,Li,Pi,Ni,$i,Ri,Fi,zi,Vi,qi,Ze,en,je,Ji],styles:[".metrics-widget[_ngcontent-%COMP%]{height:100%}.filter-bar[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.metrics-table[_ngcontent-%COMP%]{width:100%}.no-data-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:20px;color:#666}.no-data-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}mat-icon.trend-up[_ngcontent-%COMP%]{color:#4caf50}mat-icon.trend-down[_ngcontent-%COMP%]{color:#f44336}mat-icon.trend-stable[_ngcontent-%COMP%]{color:#ff9800}"]})};var At=r=>["/monitoring",r];function An(r,t){if(r&1&&_(0,"span",7),r&2){let e=m();c("matBadge",e.criticalCount)}}function Pn(r,t){r&1&&(i(0,"div",8),_(1,"mat-spinner",9),o())}function Rn(r,t){if(r&1){let e=P();i(0,"div",10)(1,"mat-icon",11),a(2,"error"),o(),i(3,"span"),a(4),o(),i(5,"button",12),p("click",function(){h(e);let s=m();return v(s.refreshAlerts())}),a(6,"Reintentar"),o()()}if(r&2){let e=m();l(4),g(e.errorMessage)}}function Fn(r,t){if(r&1&&(i(0,"mat-icon",19),a(1,"error"),o(),a(2)),r&2){let e=m(2);l(2),x(" Cr\xEDticas (",e.criticalAlerts.length,") ")}}function Ln(r,t){if(r&1&&(i(0,"div",29),a(1),o()),r&2){let e=m().$implicit;l(),x(" Elemento: ",e.elementName," ")}}function $n(r,t){if(r&1){let e=P();i(0,"div",20)(1,"div",21)(2,"div",22)(3,"mat-icon"),a(4,"error"),o(),i(5,"span",23),a(6),k(7,"date"),o()(),i(8,"div",24),a(9),o(),f(10,Ln,2,1,"div",25),o(),i(11,"div",26)(12,"button",27),p("click",function(){let s=h(e).$implicit,d=m(2);return v(d.toggleAcknowledge(s))}),i(13,"mat-icon"),a(14),o()(),i(15,"button",28)(16,"mat-icon"),a(17,"visibility"),o()()()()}if(r&2){let e=t.$implicit;l(6),g(Y(7,6,e.timestamp,"short")),l(3),g(e.message),l(),c("ngIf",e.elementName),l(2),c("matTooltip",e.acknowledged?"Reabrir":"Reconocer"),l(2),g(e.acknowledged?"check_circle":"check_circle_outline"),l(),c("routerLink",ge(9,At,e.id))}}function zn(r,t){r&1&&(i(0,"div",30),a(1," No hay alertas cr\xEDticas "),o())}function Vn(r,t){if(r&1&&(i(0,"mat-icon",31),a(1,"warning"),o(),a(2)),r&2){let e=m(2);l(2),x(" Advertencias (",e.warningAlerts.length,") ")}}function Hn(r,t){if(r&1&&(i(0,"div",29),a(1),o()),r&2){let e=m().$implicit;l(),x(" Elemento: ",e.elementName," ")}}function jn(r,t){if(r&1){let e=P();i(0,"div",32)(1,"div",21)(2,"div",22)(3,"mat-icon"),a(4,"warning"),o(),i(5,"span",23),a(6),k(7,"date"),o()(),i(8,"div",24),a(9),o(),f(10,Hn,2,1,"div",25),o(),i(11,"div",26)(12,"button",27),p("click",function(){let s=h(e).$implicit,d=m(2);return v(d.toggleAcknowledge(s))}),i(13,"mat-icon"),a(14),o()(),i(15,"button",28)(16,"mat-icon"),a(17,"visibility"),o()()()()}if(r&2){let e=t.$implicit;l(6),g(Y(7,6,e.timestamp,"short")),l(3),g(e.message),l(),c("ngIf",e.elementName),l(2),c("matTooltip",e.acknowledged?"Reabrir":"Reconocer"),l(2),g(e.acknowledged?"check_circle":"check_circle_outline"),l(),c("routerLink",ge(9,At,e.id))}}function Bn(r,t){r&1&&(i(0,"div",30),a(1," No hay alertas de advertencia "),o())}function Wn(r,t){if(r&1&&(i(0,"mat-icon",33),a(1,"info"),o(),a(2)),r&2){let e=m(2);l(2),x(" Informativas (",e.infoAlerts.length,") ")}}function Gn(r,t){if(r&1&&(i(0,"div",29),a(1),o()),r&2){let e=m().$implicit;l(),x(" Elemento: ",e.elementName," ")}}function Un(r,t){if(r&1){let e=P();i(0,"div",34)(1,"div",21)(2,"div",22)(3,"mat-icon"),a(4,"info"),o(),i(5,"span",23),a(6),k(7,"date"),o()(),i(8,"div",24),a(9),o(),f(10,Gn,2,1,"div",25),o(),i(11,"div",26)(12,"button",27),p("click",function(){let s=h(e).$implicit,d=m(2);return v(d.toggleAcknowledge(s))}),i(13,"mat-icon"),a(14),o()(),i(15,"button",28)(16,"mat-icon"),a(17,"visibility"),o()()()()}if(r&2){let e=t.$implicit;l(6),g(Y(7,6,e.timestamp,"short")),l(3),g(e.message),l(),c("ngIf",e.elementName),l(2),c("matTooltip",e.acknowledged?"Reabrir":"Reconocer"),l(2),g(e.acknowledged?"check_circle":"check_circle_outline"),l(),c("routerLink",ge(9,At,e.id))}}function Yn(r,t){r&1&&(i(0,"div",30),a(1," No hay alertas informativas "),o())}function qn(r,t){if(r&1&&(i(0,"mat-tab-group")(1,"mat-tab"),f(2,Fn,3,1,"ng-template",13),i(3,"div",14),f(4,$n,18,11,"div",15)(5,zn,2,0,"div",16),o()(),i(6,"mat-tab"),f(7,Vn,3,1,"ng-template",13),i(8,"div",14),f(9,jn,18,11,"div",17)(10,Bn,2,0,"div",16),o()(),i(11,"mat-tab"),f(12,Wn,3,1,"ng-template",13),i(13,"div",14),f(14,Un,18,11,"div",18)(15,Yn,2,0,"div",16),o()()()),r&2){let e=m();l(4),c("ngForOf",e.criticalAlerts),l(),c("ngIf",e.criticalAlerts.length===0),l(4),c("ngForOf",e.warningAlerts),l(),c("ngIf",e.warningAlerts.length===0),l(4),c("ngForOf",e.infoAlerts),l(),c("ngIf",e.infoAlerts.length===0)}}function Qn(r,t){r&1&&(i(0,"div",35)(1,"a",36),a(2," Ver todas las alertas "),o()())}var it=class r{maxAlerts=5;showViewAllButton=!0;elementId;dataLoaded=new A;errorOccurred=new A;alertAcknowledged=new A;criticalAlertsCountChanged=new A;alerts=[];loading=!1;error=!1;errorMessage="Error al cargar las alertas.";get criticalAlerts(){return this.alerts.filter(t=>t.type==="critical").slice(0,this.maxAlerts)}get warningAlerts(){return this.alerts.filter(t=>t.type==="warning").slice(0,this.maxAlerts)}get infoAlerts(){return this.alerts.filter(t=>t.type==="info").slice(0,this.maxAlerts)}get criticalCount(){return this.alerts.filter(t=>t.type==="critical"&&!t.acknowledged).length}constructor(){}ngOnInit(){this.refreshAlerts()}refreshAlerts(){this.loading=!0,this.error=!1,setTimeout(()=>{try{this.alerts=[{id:"a1",type:"critical",message:"OLT-01 fuera de l\xEDnea",timestamp:new Date(Date.now()-30*6e4).toISOString(),elementId:"olt-01",elementName:"OLT Principal",acknowledged:!1},{id:"a2",type:"warning",message:"Alta temperatura en ONT-24",timestamp:new Date(Date.now()-120*6e4).toISOString(),elementId:"ont-24",elementName:"ONT Cliente Residencial",acknowledged:!0},{id:"a3",type:"warning",message:"Se\xF1al baja en fibra troncal norte",timestamp:new Date(Date.now()-240*6e4).toISOString(),elementId:"fiber-101",elementName:"Fibra Troncal Norte",acknowledged:!1},{id:"a4",type:"info",message:"Mantenimiento programado en 2 horas",timestamp:new Date(Date.now()-360*6e4).toISOString(),acknowledged:!1},{id:"a5",type:"critical",message:"P\xE9rdida de potencia en Splitter-03",timestamp:new Date(Date.now()-45*6e4).toISOString(),elementId:"splitter-03",elementName:"Splitter Zona Este",acknowledged:!1}],this.elementId&&(this.alerts=this.alerts.filter(t=>t.elementId===this.elementId)),this.loading=!1,this.dataLoaded.emit(!0),this.criticalAlertsCountChanged.emit(this.criticalCount)}catch(t){this.handleError(t)}},1e3)}toggleAcknowledge(t){t.acknowledged=!t.acknowledged,this.alertAcknowledged.emit(t.id),this.criticalAlertsCountChanged.emit(this.criticalCount)}handleError(t){this.loading=!1,this.error=!0,this.errorMessage=t.message||"Error al cargar las alertas.",this.errorOccurred.emit(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-system-alerts-widget"]],inputs:{maxAlerts:"maxAlerts",showViewAllButton:"showViewAllButton",elementId:"elementId"},outputs:{dataLoaded:"dataLoaded",errorOccurred:"errorOccurred",alertAcknowledged:"alertAcknowledged",criticalAlertsCountChanged:"criticalAlertsCountChanged"},decls:13,vars:5,consts:[[1,"alerts-widget"],["class","alert-badge","matBadgeColor","warn",3,"matBadge",4,"ngIf"],["mat-icon-button","",3,"click"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],[4,"ngIf"],["class","view-all-alerts",4,"ngIf"],["matBadgeColor","warn",1,"alert-badge",3,"matBadge"],[1,"loading-indicator"],["diameter","30"],[1,"error-message"],["color","warn"],["mat-button","","color","primary",3,"click"],["mat-tab-label",""],[1,"alerts-list"],["class","alert-item critical",4,"ngFor","ngForOf"],["class","no-alerts",4,"ngIf"],["class","alert-item warning",4,"ngFor","ngForOf"],["class","alert-item info",4,"ngFor","ngForOf"],[1,"critical-icon"],[1,"alert-item","critical"],[1,"alert-content"],[1,"alert-header"],[1,"alert-timestamp"],[1,"alert-message"],["class","alert-element",4,"ngIf"],[1,"alert-actions"],["mat-icon-button","",3,"click","matTooltip"],["mat-icon-button","","matTooltip","Ver detalles",3,"routerLink"],[1,"alert-element"],[1,"no-alerts"],[1,"warning-icon"],[1,"alert-item","warning"],[1,"info-icon"],[1,"alert-item","info"],[1,"view-all-alerts"],["mat-button","","color","primary","routerLink","/monitoring/alerts"]],template:function(e,n){e&1&&(i(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),a(3," Alertas del Sistema "),f(4,An,1,1,"span",1),o(),i(5,"button",2),p("click",function(){return n.refreshAlerts()}),i(6,"mat-icon"),a(7,"refresh"),o()()(),i(8,"mat-card-content"),f(9,Pn,2,0,"div",3)(10,Rn,7,1,"div",4)(11,qn,16,6,"mat-tab-group",5)(12,Qn,3,0,"div",6),o()()),e&2&&(l(4),c("ngIf",n.criticalCount>0),l(5),c("ngIf",n.loading),l(),c("ngIf",n.error),l(),c("ngIf",!n.error),l(),c("ngIf",n.alerts.length>0&&!n.error))},dependencies:[C,H,D,Se,N,Z,X,J,K,M,w,O,ui,F,Q,fi,gi,Di,ki,Ti,Ii,le,R,L,q,se,ae,Ee],styles:[".alerts-widget[_ngcontent-%COMP%]{height:100%}.alert-badge[_ngcontent-%COMP%]{margin-left:8px}.critical-icon[_ngcontent-%COMP%]{color:#f44336}.warning-icon[_ngcontent-%COMP%]{color:#ff9800}.info-icon[_ngcontent-%COMP%]{color:#2196f3}.alerts-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;padding:8px 0}.alert-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px;border-radius:4px;margin-bottom:8px}.alert-item.critical[_ngcontent-%COMP%]{background-color:#f4433614;border-left:4px solid #f44336}.alert-item.warning[_ngcontent-%COMP%]{background-color:#ff980014;border-left:4px solid #ff9800}.alert-item.info[_ngcontent-%COMP%]{background-color:#2196f314;border-left:4px solid #2196f3}.alert-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:4px}.alert-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.alert-timestamp[_ngcontent-%COMP%]{color:#0000008a;font-size:12px}.alert-message[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.alert-element[_ngcontent-%COMP%]{font-size:12px;color:#0009}.alert-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.no-alerts[_ngcontent-%COMP%]{text-align:center;color:#0000008a;padding:16px}.view-all-alerts[_ngcontent-%COMP%]{text-align:center;margin-top:16px}.loading-indicator[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:16px;color:#f44336;gap:8px}"]})};var De=on(an());var Zn=["mapContainer"];function Kn(r,t){r&1&&(i(0,"div",7),_(1,"mat-spinner",8),o())}function Xn(r,t){if(r&1){let e=P();i(0,"div",9)(1,"mat-icon",10),a(2,"error"),o(),i(3,"span"),a(4),o(),i(5,"button",11),p("click",function(){h(e);let s=m();return v(s.refreshMap())}),a(6,"Reintentar"),o()()}if(r&2){let e=m();l(4),g(e.errorMessage)}}function Jn(r,t){if(r&1){let e=P();i(0,"mat-card-actions",12)(1,"button",11),p("click",function(){h(e);let s=m();return v(s.openFullMap())}),i(2,"mat-icon"),a(3,"open_in_new"),o(),a(4),o()()}if(r&2){let e=m();l(4),x(" ",e.openMapButtonText," ")}}var nt=class r{constructor(t,e,n){this.mapService=t;this.zone=e;this.el=n}mapContainer;height=200;showActions=!0;title="Vista Miniatura";openMapButtonText="Ver mapa completo";centerCoordinates;zoomLevel=12;mapReady=new A;errorOccurred=new A;mapClicked=new A;fullMapRequested=new A;mapLoaded=!1;loading=!1;error=!1;errorMessage="Error al cargar el mapa.";map=null;mapReadySubscription=null;defaultCoordinates={lat:19.78374989863946,lng:-70.67666561349361};ngOnInit(){this.loadMap()}ngOnDestroy(){this.mapReadySubscription&&this.mapReadySubscription.unsubscribe(),this.map&&(this.map.remove(),this.map=null)}refreshMap(){this.mapLoaded=!1,this.error=!1,this.map&&(this.map.remove(),this.map=null),this.loadMap()}openFullMap(){let t=this.map?{center:this.map.getCenter(),zoom:this.map.getZoom()}:null;this.fullMapRequested.emit(t),this.loading=!0,console.log("[MiniMapWidget] Evento fullMapRequested emitido para abrir mapa completo"),console.log("[MiniMapWidget] Estado actual del mapa:",t),setTimeout(()=>{this.loading=!1},300)}loadMap(){if(this.loading=!0,!this.mapContainer||!this.mapContainer.nativeElement){this.handleError(new Error("Contenedor del mapa no encontrado"));return}this.zone.runOutsideAngular(()=>{try{let t=this.mapContainer.nativeElement,e=this.centerCoordinates||this.defaultCoordinates;this.map=De.map(t,{center:[e.lat,e.lng],zoom:this.zoomLevel,zoomControl:!1,attributionControl:!1,dragging:!0,scrollWheelZoom:!1,doubleClickZoom:!1}),De.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:3,maxZoom:18}).addTo(this.map),De.marker([e.lat,e.lng],{title:"Ubicaci\xF3n actual",alt:"Marcador de ubicaci\xF3n"}).addTo(this.map).bindPopup(`
          <strong>Coordenadas</strong><br>
          Lat: ${e.lat.toFixed(6)}<br>
          Lng: ${e.lng.toFixed(6)}
        `).openPopup(),this.setupMapEvents(),this.zone.run(()=>{this.mapLoaded=!0,this.loading=!1,this.error=!1,this.mapReady.emit(!0)})}catch(t){this.zone.run(()=>{this.handleError(t)})}})}setupMapEvents(){this.map&&(this.map.on("click",t=>{this.zone.run(()=>{this.mapClicked.emit({lat:t.latlng.lat,lng:t.latlng.lng})})}),setTimeout(()=>{this.map&&this.map.invalidateSize()},100))}handleError(t){console.error("[MiniMapWidget] Error al cargar el mapa:",t),this.loading=!1,this.error=!0,this.mapLoaded=!1,this.errorMessage=t?.message||"Error al cargar el mapa.",this.errorOccurred.emit(t)}static \u0275fac=function(e){return new(e||r)(S(Wi),S(Qt),S(Ge))};static \u0275cmp=y({type:r,selectors:[["app-mini-map-widget"]],viewQuery:function(e,n){if(e&1&&ze(Zn,7),e&2){let s;xe(s=we())&&(n.mapContainer=s.first)}},inputs:{height:"height",showActions:"showActions",title:"title",openMapButtonText:"openMapButtonText",centerCoordinates:"centerCoordinates",zoomLevel:"zoomLevel"},outputs:{mapReady:"mapReady",errorOccurred:"errorOccurred",mapClicked:"mapClicked",fullMapRequested:"fullMapRequested"},decls:13,vars:6,consts:[["mapContainer",""],[1,"mini-map-widget"],["mat-icon-button","",3,"click"],[1,"map-container"],["class","loading-indicator",4,"ngIf"],["class","error-message",4,"ngIf"],["align","end",4,"ngIf"],[1,"loading-indicator"],["diameter","30"],[1,"error-message"],["color","warn"],["mat-button","","color","primary",3,"click"],["align","end"]],template:function(e,n){if(e&1){let s=P();i(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title"),a(3),o(),i(4,"button",2),p("click",function(){return h(s),v(n.refreshMap())}),i(5,"mat-icon"),a(6,"refresh"),o()()(),i(7,"mat-card-content")(8,"div",3,0),f(10,Kn,2,0,"div",4)(11,Xn,7,1,"div",5),o()(),f(12,Jn,5,1,"mat-card-actions",6),o()}e&2&&(l(3),g(n.title),l(5),oe("height",n.height,"px"),l(2),c("ngIf",n.loading),l(),c("ngIf",n.error),l(),c("ngIf",n.showActions))},dependencies:[C,D,N,Z,yi,X,J,K,M,w,O,F,Q,q,se],styles:[".mini-map-widget[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.map-container[_ngcontent-%COMP%]{flex:1;background-color:#f5f5f5;border-radius:4px;position:relative;overflow:hidden}.loading-indicator[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;justify-content:center;align-items:center;background-color:#ffffffb3;z-index:999}.error-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#f44336;gap:8px;text-align:center;padding:0 16px}"]})};var rt=class r{elementsCount=0;connectionsCount=0;warningCount=0;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-network-stats"]],inputs:{elementsCount:"elementsCount",connectionsCount:"connectionsCount",warningCount:"warningCount"},decls:16,vars:3,consts:[[1,"header-stats"],["matTooltip","Total de elementos",1,"elements-count"],[1,"count"],["matTooltip","Conexiones activas",1,"connections-count"],["matTooltip","Elementos con problemas",1,"status-count"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"span",1)(2,"mat-icon"),a(3,"device_hub"),o(),i(4,"span",2),a(5),o()(),i(6,"span",3)(7,"mat-icon"),a(8,"link"),o(),i(9,"span",2),a(10),o()(),i(11,"span",4)(12,"mat-icon"),a(13,"warning"),o(),i(14,"span",2),a(15),o()()()),e&2&&(l(5),g(n.elementsCount),l(5),g(n.connectionsCount),l(5),g(n.warningCount))},dependencies:[C,M,w,R,L],styles:[".header-stats[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-md)}.elements-count[_ngcontent-%COMP%], .connections-count[_ngcontent-%COMP%], .status-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-xs);font-size:14px;color:var(--text-color)}.elements-count[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .connections-count[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%], .status-count[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-weight:500}"]})};var ot=class r{node;onClick=new A;ElementStatus=St;getNodeIcon(t){return{FDP:"device_hub",OLT:"router",ONT:"devices",EDFA:"settings_input_component",SPLITTER:"call_split",MANGA:"fiber_manual_record"}[t]||"help"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-network-node"]],inputs:{node:"node"},outputs:{onClick:"onClick"},decls:3,vars:10,consts:[[1,"network-node",3,"click","matTooltip"],[1,"node-icon"]],template:function(e,n){e&1&&(i(0,"div",0),p("click",function(){return n.onClick.emit(n.node)}),i(1,"mat-icon",1),a(2),o()()),e&2&&(oe("left",n.node.x,"%")("top",n.node.y,"%")("background-color",n.node.color),E("node-warning",n.node.status===n.ElementStatus.FAULT),c("matTooltip",n.node.tooltip),l(2),g(n.getNodeIcon(n.node.type)))},dependencies:[C,M,w,R,L],styles:[".network-node[_ngcontent-%COMP%]{position:absolute;width:24px;height:24px;border-radius:50%;transform:translate(-50%,-50%);box-shadow:var(--shadow-sm);transition:all .3s ease;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:2}.network-node[_ngcontent-%COMP%]:hover{transform:translate(-50%,-50%) scale(1.2);box-shadow:var(--shadow-md)}.network-node.node-warning[_ngcontent-%COMP%]{background-color:var(--warn-color);animation:_ngcontent-%COMP%_pulse 2s infinite}.network-node[_ngcontent-%COMP%]   .node-icon[_ngcontent-%COMP%]{color:#fff;font-size:14px;width:14px;height:14px}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #f4433666}70%{box-shadow:0 0 0 10px #f4433600}to{box-shadow:0 0 #f4433600}}"]})};var at=class r{connection;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-network-connection"]],inputs:{connection:"connection"},decls:1,vars:10,consts:[[1,"network-connection"]],template:function(e,n){e&1&&_(0,"div",0),e&2&&(oe("left",n.connection.x,"%")("top",n.connection.y,"%")("width",n.connection.width,"px")("transform",n.connection.rotation),E("connection-inactive",n.connection.status==="inactive"))},dependencies:[C],styles:[".network-connection[_ngcontent-%COMP%]{position:absolute;height:2px;background-color:var(--primary-color);transform-origin:left center;opacity:.6;transition:all .3s ease}.network-connection.connection-inactive[_ngcontent-%COMP%]{background-color:var(--text-color);opacity:.3}"]})};function tr(r,t){r&1&&_(0,"mat-spinner",4)}function ir(r,t){if(r&1&&(i(0,"div",5)(1,"mat-icon"),a(2,"error_outline"),o(),a(3),o()),r&2){let e=m();l(3),x(" ",e.error," ")}}function nr(r,t){if(r&1){let e=P();i(0,"app-network-node",10),p("onClick",function(s){h(e);let d=m(2);return v(d.onNodeClick.emit(s))}),o()}if(r&2){let e=t.$implicit;c("node",e)}}function rr(r,t){if(r&1&&_(0,"app-network-connection",11),r&2){let e=t.$implicit;c("connection",e)}}function or(r,t){if(r&1&&(i(0,"div",6),_(1,"div",7),f(2,nr,1,1,"app-network-node",8)(3,rr,1,1,"app-network-connection",9),o()),r&2){let e=m();l(2),c("ngForOf",e.nodes),l(),c("ngForOf",e.connections)}}var st=class r{loading=!1;error=null;nodes=[];connections=[];onNodeClick=new A;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-network-preview"]],inputs:{loading:"loading",error:"error",nodes:"nodes",connections:"connections"},outputs:{onNodeClick:"onNodeClick"},decls:4,vars:3,consts:[[1,"network-preview"],["diameter","40",4,"ngIf"],["class","error-message",4,"ngIf"],["class","preview-placeholder",4,"ngIf"],["diameter","40"],[1,"error-message"],[1,"preview-placeholder"],[1,"network-grid"],[3,"node","onClick",4,"ngFor","ngForOf"],[3,"connection",4,"ngFor","ngForOf"],[3,"onClick","node"],[3,"connection"]],template:function(e,n){e&1&&(i(0,"div",0),f(1,tr,1,0,"mat-spinner",1)(2,ir,4,1,"div",2)(3,or,4,2,"div",3),o()),e&2&&(l(),c("ngIf",n.loading),l(),c("ngIf",n.error),l(),c("ngIf",!n.loading&&!n.error))},dependencies:[C,H,D,q,se,M,w,ot,at],styles:[".network-preview[_ngcontent-%COMP%]{flex:1;overflow:hidden;position:relative;background:var(--background-color);border-radius:var(--border-radius-md);margin-bottom:var(--spacing-md);display:flex;justify-content:center;align-items:center;transition:all .3s ease}.preview-placeholder[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}.network-grid[_ngcontent-%COMP%]{position:absolute;inset:0;background-image:linear-gradient(to right,var(--grid-color) 1px,transparent 1px),linear-gradient(to bottom,var(--grid-color) 1px,transparent 1px);background-size:20px 20px;opacity:.3}.error-message[_ngcontent-%COMP%]{color:var(--warn-color);text-align:center;padding:var(--spacing-md);display:flex;align-items:center;gap:var(--spacing-sm)}"]})};var lt=class r{constructor(t){this.logger=t}svg=null;mainGroup=null;nodesGroup=null;linksGroup=null;simulation=null;width=0;height=0;selectedElementId=null;isDarkMode=!1;initializeRender(t,e,n,s){this.svg=t,this.mainGroup=e,this.width=n,this.height=s,this.linksGroup=e.append("g").attr("class","links"),this.nodesGroup=e.append("g").attr("class","nodes"),this.initializeSimulation(),this.logger.debug("Componentes de renderizado inicializados")}updateNodes(t){if(!this.nodesGroup||!this.simulation)return;this.simulation.nodes(t);let e=this.nodesGroup.selectAll(".node").data(t,s=>s.id);e.exit().remove();let n=e.enter().append("g").attr("class","node").attr("id",s=>`node-${s.id}`).call(this.configureDrag());n.append("circle").attr("r",s=>s.isPreview?8:15).attr("fill",s=>this.getElementColor(s.type||"",s.status||"")).attr("stroke",s=>s.isPreview?"#FF4081":"#ffffff").attr("stroke-width",s=>s.isPreview?2:1).attr("class",s=>s.isPreview?"preview-node":""),n.append("text").attr("dy",".35em").attr("y",30).style("text-anchor","middle").style("fill",this.isDarkMode?"#e0e0e0":"#333333").style("font-size","12px").style("pointer-events","none").text(s=>s.name||""),this.nodesGroup.selectAll(".node").each(function(s){let d=kt(this);d.select("circle").attr("fill",s.isPreview?"#FF4081":s.color||"#4CAF50").attr("stroke",s.isPreview?"#FF4081":"#ffffff"),d.select("text").text(s.name||"")})}updateLinks(t){if(!this.linksGroup||!this.simulation)return;this.simulation.force("link",Dt(t).id(s=>s.id).distance(s=>s.distance||100).strength(s=>s.strength||.1));let e=this.linksGroup.selectAll(".link").data(t,s=>`${s.source.id||s.source}-${s.target.id||s.target}`);e.exit().remove();let n=e.enter().append("line").attr("class","link").attr("stroke",s=>s.color||"#999").attr("stroke-width",s=>s.width||1).attr("stroke-dasharray",s=>s.dashed?"5, 5":"none");this.linksGroup.selectAll(".link").each(function(s){kt(this).attr("stroke",s.color||"#999").attr("stroke-width",s.width||1).attr("stroke-dasharray",s.dashed?"5, 5":"none")})}updatePositions(){!this.nodesGroup||!this.linksGroup||(this.nodesGroup.selectAll(".node").attr("transform",t=>`translate(${t.x||0},${t.y||0})`),this.linksGroup.selectAll(".link").attr("x1",t=>t.source.x||0).attr("y1",t=>t.source.y||0).attr("x2",t=>t.target.x||0).attr("y2",t=>t.target.y||0))}convertToD3Nodes(t){return t.map(e=>{let n=e.position?.coordinates?.[0]||0,s=e.position?.coordinates?.[1]||0,d=this.width/2+n*(this.width/360),u=this.height/2-s*(this.height/180);return ue(pe({},e),{x:d,y:u,fx:e.metadata?.fixed?d:null,fy:e.metadata?.fixed?u:null})})}convertToD3Links(t,e){let n=new Map(e.map(s=>[s.id,s]));return t.reduce((s,d)=>{let u=n.get(d.sourceElementId),I=n.get(d.targetElementId);if(!u||!I)return this.logger.warn(`Elemento fuente o destino no encontrado para la conexi\xF3n: ${d.id??"N/A"}. Saltando conexi\xF3n.`),s;let ve=ue(pe({},d),{source:u.id,target:I.id,sourceId:d.sourceElementId,targetId:d.targetElementId,value:d.properties?.weight||this.getLinkStrength(d)||1});return s.push(ve),s},[])}getLinkStrength(t){switch(t.type){case"FIBER":return .2;case"COPPER":return .3;case"WIRELESS":return .1;case"LOGICAL":return .05;default:return .15}}highlightSelectedElement(t){this.nodesGroup&&(this.selectedElementId=t,this.nodesGroup.selectAll(".node circle").classed("selected",!1).attr("stroke-width",1).attr("r",e=>e.isPreview?8:15),t&&this.nodesGroup.selectAll(".node").filter(e=>e.id===t).select("circle").classed("selected",!0).attr("stroke-width",3).attr("r",18))}getElementColor(t,e){if(e)switch(e){case"ACTIVE":return"#4CAF50";case"INACTIVE":return"#9E9E9E";case"FAILED":return"#F44336";case"DEGRADED":return"#FF9800";case"PLANNED":return"#2196F3"}switch(t){case"OLT":return"#4CAF50";case"ONT":return"#FF9800";case"FDP":return"#2196F3";case"SPLITTER":return"#9C27B0";case"EDFA":return"#F44336";case"MANGA":return"#795548";case"MSAN":return"#009688";case"TERMINAL_BOX":return"#607D8B";case"SLACK_FIBER":return"#80DEEA";default:return"#673AB7"}}clearRender(){this.nodesGroup&&this.nodesGroup.selectAll("*").remove(),this.linksGroup&&this.linksGroup.selectAll("*").remove(),this.simulation&&this.simulation.stop()}refreshRenderSize(t,e){!this.svg||!this.simulation||(this.width=t,this.height=e,this.svg.attr("width",t).attr("height",e).attr("viewBox",`0 0 ${t} ${e}`),this.simulation.force("center",It(t/2,e/2)),this.simulation.alpha(.3).restart())}setDarkMode(t){this.isDarkMode=t,this.nodesGroup&&this.nodesGroup.selectAll(".node text").style("fill",t?"#e0e0e0":"#333333")}initializeSimulation(){try{this.simulation=ji().force("link",Dt().id(t=>t.id).distance(100)).force("charge",Bi().strength(-300)).force("center",It(this.width/2,this.height/2)).on("tick",()=>this.updatePositions()),this.logger.debug("Simulaci\xF3n D3 inicializada con \xE9xito")}catch(t){this.logger.error("Error al inicializar la simulaci\xF3n D3:",t)}}configureDrag(){return this.simulation?Tt().on("start",(t,e)=>{t.active||this.simulation?.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}).on("drag",(t,e)=>{e.fx=t.x,e.fy=t.y}).on("end",(t,e)=>{t.active||this.simulation?.alphaTarget(0),e.fixed||(e.fx=null,e.fy=null)}):Tt()}getConnectionStyleByStatus(t){let e="#2196f3",n=1,s="",d=.8;switch(t.status){case"ACTIVE":e="#4caf50",n=2;break;case"INACTIVE":e="#9e9e9e",n=1,s="3,3",d=.5;break;case"DEGRADED":e="#ff9800",n=2,s="5,2";break;case"FAILED":e="#f44336",n=2;break;case"PLANNED":e="#9c27b0",n=1.5,s="5,5",d=.6;break;default:e="#2196f3",n=1}return{stroke:e,strokeWidth:n,strokeOpacity:d,strokeDasharray:s}}getConnectionColorByType(t){switch(t.type){case"FIBER":return"#03a9f4";case"COPPER":return"#ff5722";case"WIRELESS":return"#8bc34a";case"LOGICAL":return"#9c27b0";default:return"#2196f3"}}static \u0275fac=function(e){return new(e||r)(re(xi))};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var tn=()=>[],lr=()=>["/network-design"],ct=class r{constructor(t,e){this.store=t;this.renderService=e}subscriptions=[];elementsCount$=b(0);connectionsCount$=b(0);warningCount$=b(0);previewNodes$=b([]);previewConnections$=b([]);loading=!0;error=null;ngOnInit(){this.loadNetworkData(),this.setupAutoRefresh()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadNetworkData(){this.loading=!0,this.error=null,this.store.select(t=>t.network).pipe($t(1),te(t=>{if(t.error)return this.error="Error al cargar los datos de la red",this.loading=!1,{elements:[],connectionsCount:0,connectionsForPreview:[],warnings:0};let e=[...t.fdps||[],...t.olts||[],...t.onts||[],...t.edfas||[],...t.splitters||[],...t.mangas||[]],n=t.fiberConnections||[],s=[];return{elements:e,connectionsCount:n.length,connectionsForPreview:s,warnings:e.filter(d=>d.status==="FAULT"||d.status==="ERROR"||d.status==="WARNING"||d.status==="CRITICAL").length||0}})).subscribe({next:t=>{this.elementsCount$=b(t.elements.length),this.connectionsCount$=b(t.connectionsCount||0),this.warningCount$=b(t.warnings||0),this.previewNodes$=b(t.elements.map(e=>this.createNodeData(e))),this.previewConnections$=b((t.connectionsForPreview||[]).map(e=>this.createConnectionDataForPreview(e,t.elements)).filter(e=>e!==null)),this.loading=!1},error:t=>{this.error="Error al procesar datos de la red",this.loading=!1,this.elementsCount$=b(0),this.connectionsCount$=b(0),this.warningCount$=b(0),this.previewNodes$=b([]),this.previewConnections$=b([])}})}setupAutoRefresh(){let t=this.store.select(e=>e.network).pipe(te(e=>(e.fiberConnections||[]).length),zt()).subscribe(()=>this.loadNetworkData());this.subscriptions.push(t)}onNodeClick(t){}refreshPreview(){this.loadNetworkData()}createConnectionDataForPreview(t,e){let n=e.find(Ae=>Ae.id===t.sourceElementId),s=e.find(Ae=>Ae.id===t.targetElementId);if(!n||!s||!n.position?.coordinates||!s.position?.coordinates)return null;let d=n.position.coordinates[0],u=n.position.coordinates[1],I=s.position.coordinates[0],ve=s.position.coordinates[1],me=I-d,ne=ve-u,_e=Math.sqrt(me*me+ne*ne)*.5,Ne=Math.atan2(ne,me)*(180/Math.PI),gt=d,ft=u,Be="inactive";return t.status==="ACTIVE"&&(Be="active"),{x:gt,y:ft,width:_e,rotation:`rotate(${Ne}deg)`,status:Be}}createNodeData(t){let e=t.position?.coordinates?.[0]||Math.random()*90+5,n=t.position?.coordinates?.[1]||Math.random()*90+5;return{id:t.id,x:e%100,y:n%100,color:this.getElementColor(t),tooltip:`${t.name} (${t.type}) - ${t.status}`,type:t.type,status:t.status}}getElementColor(t){return t.status==="ERROR"||t.status==="FAULT"?"var(--error-color)":t.status==="WARNING"?"var(--warn-color)":t.status==="ACTIVE"?"var(--success-color)":"var(--neutral-color)"}static \u0275fac=function(e){return new(e||r)(S(Qi),S(lt))};static \u0275cmp=y({type:r,selectors:[["app-network-widget"]],decls:23,vars:21,consts:[[1,"network-widget"],[1,"widget-header"],[1,"header-content"],[1,"header-icon"],[3,"elementsCount","connectionsCount","warningCount"],[3,"onNodeClick","loading","error","nodes","connections"],[1,"widget-footer"],["mat-button","","color","primary",3,"routerLink"],["mat-button","","color","accent",3,"click"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),a(4,"network_check"),o(),i(5,"h3"),a(6,"Vista Previa de Red"),o()(),_(7,"app-network-stats",4),k(8,"async"),k(9,"async"),k(10,"async"),o(),i(11,"app-network-preview",5),k(12,"async"),k(13,"async"),p("onNodeClick",function(d){return n.onNodeClick(d)}),o(),i(14,"div",6)(15,"button",7)(16,"mat-icon"),a(17,"map"),o(),a(18," Ver Mapa Completo "),o(),i(19,"button",8),p("click",function(){return n.refreshPreview()}),i(20,"mat-icon"),a(21,"refresh"),o(),a(22," Actualizar "),o()()()),e&2&&(l(7),c("elementsCount",ie(8,8,n.elementsCount$)||0)("connectionsCount",ie(9,10,n.connectionsCount$)||0)("warningCount",ie(10,12,n.warningCount$)||0),l(4),c("loading",n.loading)("error",n.error)("nodes",ie(12,14,n.previewNodes$)||Me(18,tn))("connections",ie(13,16,n.previewConnections$)||Me(19,tn)),l(4),c("routerLink",Me(20,lr)))},dependencies:[C,qe,ae,Ee,N,O,F,M,w,le,q,rt,st],styles:[".network-widget[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:var(--spacing-md);background:var(--background-color);border-radius:var(--border-radius-md);box-shadow:var(--shadow-md);transition:all .3s ease}.widget-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-md);padding-bottom:var(--spacing-sm);border-bottom:1px solid var(--border-color)}.header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm)}.header-icon[_ngcontent-%COMP%]{color:var(--primary-color);font-size:24px;width:24px;height:24px}.widget-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-top:var(--spacing-sm);border-top:1px solid var(--border-color)}"]})};function cr(r,t){r&1&&(i(0,"span"),a(1,"Dise\xF1o de Red"),o())}function dr(r,t){r&1&&(i(0,"span"),a(1,"Monitoreo"),o())}function mr(r,t){r&1&&(i(0,"span"),a(1,"Reportes"),o())}function pr(r,t){r&1&&(i(0,"span"),a(1,"Configuraci\xF3n"),o())}var dt=class r{isCompact=!1;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-quick-nav-menu"]],inputs:{isCompact:"isCompact"},decls:17,vars:6,consts:[[1,"quick-nav-panel"],["mat-button","","color","primary","routerLink","/network-design","matTooltip","Dise\xF1o de Red"],[4,"ngIf"],["mat-button","","color","primary","routerLink","/network-monitoring","matTooltip","Monitoreo"],["mat-button","","color","primary","routerLink","/reports","matTooltip","Reportes"],["mat-button","","color","primary","routerLink","/settings","matTooltip","Configuraci\xF3n"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"button",1)(2,"mat-icon"),a(3,"device_hub"),o(),f(4,cr,2,0,"span",2),o(),i(5,"button",3)(6,"mat-icon"),a(7,"monitor_heart"),o(),f(8,dr,2,0,"span",2),o(),i(9,"button",4)(10,"mat-icon"),a(11,"assessment"),o(),f(12,mr,2,0,"span",2),o(),i(13,"button",5)(14,"mat-icon"),a(15,"settings"),o(),f(16,pr,2,0,"span",2),o()()),e&2&&(E("compact",n.isCompact),l(4),c("ngIf",!n.isCompact),l(4),c("ngIf",!n.isCompact),l(4),c("ngIf",!n.isCompact),l(4),c("ngIf",!n.isCompact))},dependencies:[C,D,O,F,M,w,R,L,ae,Ee],styles:[".quick-nav-panel[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;padding:10px;background-color:#f5f5f5;border-radius:4px}.quick-nav-panel.compact[_ngcontent-%COMP%]{flex-direction:column;width:fit-content}.quick-nav-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.quick-nav-panel.compact[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:auto;padding:8px;border-radius:50%;aspect-ratio:1/1;justify-content:center}@media (max-width: 600px){.quick-nav-panel[_ngcontent-%COMP%]:not(.compact){flex-direction:column}}"]})};var de=class r{constructor(t){this.http=t}apiUrl=`${fe.apiUrl}/dashboard`;loadingSubject=new z(!1);loading$=this.loadingSubject.asObservable();metricsSubject=new z([{id:"metric1",name:"Uso de CPU",value:65,unit:"%",trend:2.5,timestamp:new Date,status:"ACTIVE",type:"signal_quality",history:[{value:62,timestamp:new Date(Date.now()-36e5)},{value:58,timestamp:new Date(Date.now()-72e5)}]},{id:"metric2",name:"Memoria Disponible",value:28,unit:"%",trend:-3.5,timestamp:new Date,status:"WARNING",type:"signal_quality",history:[{value:35,timestamp:new Date(Date.now()-36e5)},{value:32,timestamp:new Date(Date.now()-72e5)}]},{id:"metric3",name:"Tr\xE1fico de Red",value:85,unit:"Mbps",trend:5.2,timestamp:new Date,status:"ACTIVE",type:"bandwidth",history:[{value:78,timestamp:new Date(Date.now()-36e5)},{value:82,timestamp:new Date(Date.now()-72e5)}]},{id:"metric4",name:"Latencia",value:120,unit:"ms",trend:15.5,timestamp:new Date,status:"FAULT",type:"latency",history:[{value:85,timestamp:new Date(Date.now()-36e5)},{value:90,timestamp:new Date(Date.now()-72e5)}]}]);alertsSubject=new z([{id:he(),type:"error",message:"Alta atenuaci\xF3n detectada en segmento FIBER-001",timestamp:new Date,source:"Sistema",status:"active",deviceId:"OLT-001",elementType:"OLT",elementId:"OLT-001",fiberSegment:"FIBER-001",distance:2.5,opticalPower:-18.5,affectedElements:["ONT-001","ONT-002","ONT-003"],priority:"high",resolution:"Requiere revisi\xF3n del empalme en punto A",maintenanceSchedule:new Date(Date.now()+864e5),acknowledged:!1},{id:he(),type:"warning",message:"Potencia \xF3ptica baja en ONT-003",timestamp:new Date(Date.now()-36e5),source:"Sistema",status:"active",deviceId:"ONT-003",elementType:"ONT",elementId:"ONT-003",opticalPower:-25.5,priority:"medium",acknowledged:!1},{id:he(),type:"info",message:"Mantenimiento programado en splitter SPL-002",timestamp:new Date(Date.now()-72e5),source:"Sistema",status:"active",deviceId:"SPL-002",elementType:"SPLITTER",elementId:"SPL-002",priority:"low",maintenanceSchedule:new Date(Date.now()+1728e5),acknowledged:!0}]);activitiesSubject=new z([{id:he(),type:"maintenance",action:"Mantenimiento preventivo en OLT-001",user:"admin",timestamp:new Date,details:"Limpieza de conectores y verificaci\xF3n de potencia",deviceId:"OLT-001",deviceType:"OLT",location:"Nodo Central",maintenanceType:"preventive",elementType:"OLT",elementId:"OLT-001",workOrderId:"WO-2024-001",technician:"Juan P\xE9rez",estimatedDuration:120,completionStatus:"in-progress"},{id:he(),type:"monitor",action:"Nuevo ONT detectado",user:"sistema",timestamp:new Date(Date.now()-36e5),details:"ONT-004 conectado en puerto 1/1/1:1",deviceId:"ONT-004",deviceType:"ONT",location:"Cliente ABC",elementType:"ONT",elementId:"ONT-004",completionStatus:"completed"},{id:he(),type:"alert",action:"Alerta de degradaci\xF3n de se\xF1al",user:"sistema",timestamp:new Date(Date.now()-72e5),details:"Degradaci\xF3n detectada en empalme SPL-001",deviceId:"SPL-001",deviceType:"SPLITTER",location:"Nodo Secundario",fiberSegment:"FIBER-002",splicePoint:"SPL-001",affectedUsers:8,elementType:"SPLITTER",elementId:"SPL-001",workOrderId:"WO-2024-002",completionStatus:"pending"}]);getDashboardSummary(t="day"){return this.loadingSubject.next(!0),b(this.getMockDashboardData(t)).pipe(Ce(e=>{this.metricsSubject.next(e.performanceMetrics),this.alertsSubject.next(e.alerts),this.activitiesSubject.next(e.recentActivities)}),W(500),Vt(()=>this.loadingSubject.next(!1)))}getStatCards(){return b(this.getMockDashboardData().stats).pipe(W(300))}getRecentActivities(t=10){return b(this.getMockDashboardData().recentActivities.slice(0,t)).pipe(W(400))}getPerformanceMetrics(){return b(this.getMockDashboardData().performanceMetrics).pipe(W(450))}getSystemAlerts(t=!1){let e=this.getMockDashboardData().alerts,n=t?e:e.filter(s=>!s.acknowledged);return b(n).pipe(W(350))}acknowledgeAlert(t){return this.http.patch(`${this.apiUrl}/alerts/${t}/acknowledge`,{}).pipe(te(e=>{let n=this.alertsSubject.value,s=n.findIndex(d=>d.id===t);return s!==-1&&(n[s]=e,this.alertsSubject.next(n)),!0}))}getMockDashboardData(t="day"){let e=new Date,n=d=>{let u=new Date(e);return u.setMinutes(u.getMinutes()-d),u},s=[];switch(t){case"week":s=[{id:"1",title:"Total de Clientes",value:"1,345",icon:"people",color:"#1976d2",trend:8},{id:"2",title:"Redes Activas",value:"52",icon:"wifi",color:"#4caf50",trend:15},{id:"3",title:"Ancho de Banda Total",value:"12 Gbps",icon:"speed",color:"#ff9800",trend:20},{id:"4",title:"Uptime",value:"99.5%",icon:"schedule",color:"#9c27b0",trend:-.4}];break;case"month":s=[{id:"1",title:"Total de Clientes",value:"1,502",icon:"people",color:"#1976d2",trend:22},{id:"2",title:"Redes Activas",value:"58",icon:"wifi",color:"#4caf50",trend:29},{id:"3",title:"Ancho de Banda Total",value:"15 Gbps",icon:"speed",color:"#ff9800",trend:50},{id:"4",title:"Uptime",value:"99.3%",icon:"schedule",color:"#9c27b0",trend:-.6}];break;default:s=[{id:"1",title:"Total de Clientes",value:"1,234",icon:"people",color:"#1976d2",trend:5},{id:"2",title:"Redes Activas",value:"45",icon:"wifi",color:"#4caf50",trend:0},{id:"3",title:"Ancho de Banda Total",value:"10 Gbps",icon:"speed",color:"#ff9800",trend:12},{id:"4",title:"Uptime",value:"99.9%",icon:"schedule",color:"#9c27b0",trend:.2}]}return{stats:s,recentActivities:[{id:"act1",type:"maintenance",action:"Nueva red creada en Zona Norte",user:"admin",timestamp:n(5),deviceId:"net123",deviceType:"OTHER"},{id:"act2",type:"maintenance",action:"Actualizaci\xF3n de firmware en OLT-001",user:"admin",timestamp:n(60),deviceId:"olt001",deviceType:"OLT"},{id:"act3",type:"maintenance",action:"Nuevo cliente agregado: Empresa XYZ",user:"admin",timestamp:n(120),deviceId:"client456",deviceType:"OTHER"},{id:"act4",type:"maintenance",action:"Mantenimiento programado para ma\xF1ana",user:"admin",timestamp:n(1440),deviceId:"maintenance001",deviceType:"OTHER"},{id:"act5",type:"alert",action:"Alerta: Alto consumo de ancho de banda en Sector B",user:"sistema",timestamp:n(30),deviceId:"sector-b",deviceType:"OTHER"}],alerts:[{id:"alert1",type:"warning",message:"Alto consumo de ancho de banda en el sector B que podr\xEDa afectar el servicio.",timestamp:n(30),source:"Sistema",status:"active",deviceId:"sector-b",elementType:"OTHER",acknowledged:!1},{id:"alert2",type:"error",message:"El dispositivo OLT-003 est\xE1 offline y no responde a ping.",timestamp:n(45),source:"Sistema",status:"active",deviceId:"olt003",elementType:"OLT",acknowledged:!1},{id:"alert3",type:"info",message:"Hay una actualizaci\xF3n de firmware disponible para los dispositivos ONT.",timestamp:n(120),source:"Sistema",status:"active",deviceId:"system",acknowledged:!0},{id:"alert4",type:"critical",message:"El nodo principal del centro de datos presenta fallos cr\xEDticos que requieren atenci\xF3n inmediata.",timestamp:n(15),source:"Sistema",status:"active",deviceId:"main-node",elementType:"OTHER",acknowledged:!1}],performanceMetrics:[{id:"metric1",name:"Uso de CPU",value:65,unit:"%",trend:2.5,timestamp:e,status:"ACTIVE",type:"signal_quality",history:[{value:62,timestamp:n(60)},{value:58,timestamp:n(120)},{value:61,timestamp:n(180)},{value:65,timestamp:n(240)}]},{id:"metric2",name:"Memoria Disponible",value:28,unit:"%",trend:-3.5,timestamp:e,status:"WARNING",type:"signal_quality",history:[{value:35,timestamp:n(60)},{value:32,timestamp:n(120)},{value:30,timestamp:n(180)},{value:28,timestamp:n(240)}]},{id:"metric3",name:"Tr\xE1fico de Red",value:85,unit:"Mbps",trend:5.2,timestamp:e,status:"ACTIVE",type:"bandwidth",history:[{value:78,timestamp:n(60)},{value:82,timestamp:n(120)},{value:80,timestamp:n(180)},{value:85,timestamp:n(240)}]},{id:"metric4",name:"Latencia",value:120,unit:"ms",trend:15.5,timestamp:e,status:"FAULT",type:"latency",history:[{value:85,timestamp:n(60)},{value:90,timestamp:n(120)},{value:105,timestamp:n(180)},{value:120,timestamp:n(240)}]}]}}getMetrics(){return this.metricsSubject.asObservable()}refreshMetrics(){return this.loadingSubject.next(!0),b(this.metricsSubject.value).pipe(W(1e3))}getAlerts(){return this.alertsSubject.asObservable()}getActiveAlerts(){return this.getAlerts().pipe(te(t=>t.filter(e=>!e.acknowledged)))}refreshAlerts(){return this.loadingSubject.next(!0),b(this.alertsSubject.value).pipe(W(1e3),Ce(()=>this.loadingSubject.next(!1)))}toggleAlertStatus(t){return this.http.patch(`${this.apiUrl}/alerts/${t}/toggle`,{})}getActivities(){return this.activitiesSubject.asObservable()}refreshActivities(){return this.loadingSubject.next(!0),b(this.activitiesSubject.value).pipe(W(1e3))}exportDashboard(t){return this.loadingSubject.next(!0),b(!0).pipe(W(2e3))}getDevices(){return this.http.get(`${this.apiUrl}/devices`)}getDeviceById(t){return this.http.get(`${this.apiUrl}/devices/${t}`)}getDevicesByType(t){return this.getDevices().pipe(te(e=>e.filter(n=>n.type===t)))}createDevice(t){return this.http.post(`${this.apiUrl}/devices`,t)}updateDevice(t,e){return this.http.patch(`${this.apiUrl}/devices/${t}`,e)}deleteDevice(t){return this.http.delete(`${this.apiUrl}/devices/${t}`)}getSegments(){return this.http.get(`${this.apiUrl}/segments`)}getSegmentById(t){return this.http.get(`${this.apiUrl}/segments/${t}`)}createSegment(t){return this.http.post(`${this.apiUrl}/segments`,t)}updateSegment(t,e){return this.http.patch(`${this.apiUrl}/segments/${t}`,e)}deleteSegment(t){return this.http.delete(`${this.apiUrl}/segments/${t}`)}getConnections(){return this.http.get(`${this.apiUrl}/connections`)}getConnectionById(t){return this.http.get(`${this.apiUrl}/connections/${t}`)}createConnection(t){return this.http.post(`${this.apiUrl}/connections`,t)}updateConnection(t,e){return this.http.patch(`${this.apiUrl}/connections/${t}`,e)}deleteConnection(t){return this.http.delete(`${this.apiUrl}/connections/${t}`)}getNetwork(){return this.http.get(`${this.apiUrl}/network`)}updateNetwork(t){return this.http.patch(`${this.apiUrl}/network`,t)}getNetworkMetrics(){return this.http.get(`${this.apiUrl}/metrics`)}getDeviceMetrics(t){return this.http.get(`${this.apiUrl}/devices/${t}/metrics`)}getSegmentMetrics(t){return this.http.get(`${this.apiUrl}/segments/${t}/metrics`)}static \u0275fac=function(e){return new(e||r)(re(Qe))};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var Oe=class r{constructor(t){this.dashboardService=t}refreshInterval=3e4;loadingSubject=new z(!1);loading$=this.loadingSubject.asObservable();statsSubject=new z([]);stats$=this.statsSubject.asObservable();activitiesSubject=new z([]);activities$=this.activitiesSubject.asObservable();metricsSubject=new z([]);metrics$=this.metricsSubject.asObservable();alertsSubject=new z([]);alerts$=this.alertsSubject.asObservable();periodSubject=new z("day");period$=this.periodSubject.asObservable();dashboardSummary$=Ft(this.refreshInterval).pipe(jt(0),Ce(()=>this.loadingSubject.next(!0)),Bt(()=>this.dashboardService.getDashboardSummary(this.periodSubject.getValue())),Ce(t=>{this.statsSubject.next(t.stats),this.activitiesSubject.next(t.recentActivities),this.metricsSubject.next(t.performanceMetrics),this.alertsSubject.next(t.alerts),this.loadingSubject.next(!1)}),Ht(1));loadDashboardData(){this.dashboardSummary$.subscribe()}getRecentActivities(t=10){return this.dashboardService.getRecentActivities(t)}getSystemAlerts(t=!1){return this.dashboardService.getSystemAlerts(t)}acknowledgeAlert(t){return this.dashboardService.acknowledgeAlert(t)}refreshAll(){this.loadingSubject.next(!0),this.dashboardService.getDashboardSummary(this.periodSubject.getValue()).subscribe(t=>{this.statsSubject.next(t.stats),this.activitiesSubject.next(t.recentActivities),this.metricsSubject.next(t.performanceMetrics),this.alertsSubject.next(t.alerts),this.loadingSubject.next(!1)})}refreshSection(t){switch(this.loadingSubject.next(!0),t){case"health":case"network":console.log("Actualizando datos de red/salud"),setTimeout(()=>this.loadingSubject.next(!1),1e3);break;case"metrics":this.dashboardService.getPerformanceMetrics().subscribe(e=>{this.metricsSubject.next(e),this.loadingSubject.next(!1)});break;case"alerts":this.dashboardService.getSystemAlerts().subscribe(e=>{this.alertsSubject.next(e),this.loadingSubject.next(!1)});break;case"activities":this.dashboardService.getRecentActivities().subscribe(e=>{this.activitiesSubject.next(e),this.loadingSubject.next(!1)});break;default:this.refreshAll()}}setPeriod(t){this.periodSubject.getValue()!==t&&(this.periodSubject.next(t),this.loadingSubject.next(!0),this.dashboardService.getDashboardSummary(t).subscribe(e=>{this.statsSubject.next(e.stats),this.activitiesSubject.next(e.recentActivities),this.metricsSubject.next(e.performanceMetrics),this.alertsSubject.next(e.alerts),this.loadingSubject.next(!1)}))}exportDashboard(t){this.loadingSubject.next(!0),console.log(`Exportando dashboard en formato ${t}`),setTimeout(()=>{alert(`Dashboard exportado en formato ${t}`),this.loadingSubject.next(!1)},1500)}static \u0275fac=function(e){return new(e||r)(re(de))};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var hr=(r,t,e)=>({positive:r,neutral:t,negative:e});function vr(r,t){if(r&1&&(i(0,"div",8)(1,"mat-icon",9),a(2),o(),i(3,"span"),a(4),o()()),r&2){let e=m().$implicit,n=m();c("ngClass",Jt(4,hr,e.trend>0,e.trend===0,e.trend<0))("matTooltip",n.getTrendTooltip(e)),l(2),x(" ",e.trend>0?"trending_up":e.trend<0?"trending_down":"trending_flat"," "),l(2),g(n.getFormattedTrend(e.trend))}}function _r(r,t){if(r&1&&(i(0,"div",3)(1,"div",4)(2,"mat-icon"),a(3),o()(),i(4,"div",5)(5,"h3"),a(6),o(),i(7,"p",6),a(8),o(),f(9,vr,5,8,"div",7),o()()),r&2){let e=t.$implicit;l(),oe("color",e.color||"#1976d2"),l(2),g(e.icon||"trending_up"),l(3),g(e.title),l(2),g(e.value),l(),c("ngIf",e.trend!==void 0)}}var mt=class r{constructor(t){this.dashboardFacade=t}stats=[];ngOnInit(){(!this.stats||this.stats.length===0)&&this.dashboardFacade.stats$.subscribe(t=>{t&&t.length>0&&(this.stats=t)})}getFormattedTrend(t){return t===0?"0%":`${t>0?"+":""}${t}%`}getTrendTooltip(t){if(t.trend===void 0)return"";if(t.trend===0)return"Sin cambios";let e=t.trend>0?"aument\xF3":"disminuy\xF3";return`${t.title} ${e} un ${Math.abs(t.trend)}% en el \xFAltimo per\xEDodo`}static \u0275fac=function(e){return new(e||r)(S(Oe))};static \u0275cmp=y({type:r,selectors:[["app-stat-cards"]],inputs:{stats:"stats"},decls:3,vars:1,consts:[[1,"stat-cards-wrapper"],[1,"stats-grid"],["class","stat-card",4,"ngFor","ngForOf"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-value"],["class","stat-trend",3,"ngClass","matTooltip",4,"ngIf"],[1,"stat-trend",3,"ngClass","matTooltip"],[1,"trend-icon"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1),f(2,_r,10,6,"div",2),o()()),e&2&&(l(2),c("ngForOf",n.stats))},dependencies:[C,V,H,D,N,M,w,ke,R,L],styles:[".stat-cards-wrapper[_ngcontent-%COMP%]{width:100%;padding:0}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin-bottom:24px}.stat-card[_ngcontent-%COMP%]{display:flex;padding:16px;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #00000026}.stat-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;font-size:2rem;margin-right:16px;width:48px;height:48px;border-radius:50%;background-color:#1976d21a}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.stat-content[_ngcontent-%COMP%]{flex:1}.stat-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666;font-weight:500}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin:4px 0}.stat-trend[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12px;line-height:12px}.trend-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px;margin-right:4px}.positive[_ngcontent-%COMP%]{color:#4caf50}.negative[_ngcontent-%COMP%]{color:#f44336}.neutral[_ngcontent-%COMP%]{color:#757575}@media (max-width: 768px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 480px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};function br(r,t){if(r&1&&(i(0,"p",17),a(1),o()),r&2){let e=m().$implicit;l(),x(" ",e.details," ")}}function yr(r,t){if(r&1&&(i(0,"span",24),a(1),o()),r&2){let e=m(3).$implicit;l(),x("(",e.deviceType,")")}}function Cr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Dispositivo:"),o(),i(3,"span",22),a(4),o(),f(5,yr,2,1,"span",23),o()),r&2){let e=m(2).$implicit;l(4),g(e.deviceId),l(),c("ngIf",e.deviceType)}}function xr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Ubicaci\xF3n:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.location)}}function wr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Segmento:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.fiberSegment)}}function Mr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Tipo de mantenimiento:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.maintenanceType==="preventive"?"Preventivo":"Correctivo")}}function Sr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Usuarios afectados:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.affectedUsers)}}function Er(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Orden de trabajo:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.workOrderId)}}function kr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"T\xE9cnico:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),g(e.technician)}}function Tr(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Duraci\xF3n estimada:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit;l(4),x("",e.estimatedDuration," minutos")}}function Ir(r,t){if(r&1&&(i(0,"div",20)(1,"span",21),a(2,"Estado:"),o(),i(3,"span",22),a(4),o()()),r&2){let e=m(2).$implicit,n=m();l(4),g(n.getCompletionStatusLabel(e.completionStatus))}}function Dr(r,t){if(r&1&&(i(0,"div",18),f(1,Cr,6,2,"div",19)(2,xr,5,1,"div",19)(3,wr,5,1,"div",19)(4,Mr,5,1,"div",19)(5,Sr,5,1,"div",19)(6,Er,5,1,"div",19)(7,kr,5,1,"div",19)(8,Tr,5,1,"div",19)(9,Ir,5,1,"div",19),o()),r&2){let e=m().$implicit;l(),c("ngIf",e.deviceId),l(),c("ngIf",e.location),l(),c("ngIf",e.fiberSegment),l(),c("ngIf",e.maintenanceType),l(),c("ngIf",e.affectedUsers),l(),c("ngIf",e.workOrderId),l(),c("ngIf",e.technician),l(),c("ngIf",e.estimatedDuration),l(),c("ngIf",e.completionStatus)}}function Or(r,t){if(r&1&&(i(0,"div",6)(1,"div",7)(2,"mat-icon"),a(3),o()(),i(4,"div",8)(5,"div",9)(6,"span",10),a(7),o(),i(8,"span",11),a(9),k(10,"date"),o()(),i(11,"div",12)(12,"span",13),a(13),o(),i(14,"span",14),a(15),o()(),f(16,br,2,1,"p",15)(17,Dr,10,9,"div",16),o()()),r&2){let e=t.$implicit,n=m();l(),c("ngClass",e.type),l(2),g(n.getActivityIcon(e.type)),l(4),g(e.action),l(2),g(Y(10,9,e.timestamp,"short")),l(4),g(e.user),l(),c("matTooltip",n.getActivityTypeTooltip(e.type)),l(),x(" ",n.getActivityTypeLabel(e.type)," "),l(),c("ngIf",e.details),l(),c("ngIf",e.deviceId||e.location||e.fiberSegment)}}function Nr(r,t){r&1&&(i(0,"div",25)(1,"mat-icon"),a(2,"history"),o(),i(3,"p"),a(4,"No hay actividades recientes"),o()())}var pt=class r{constructor(t){this.dashboardService=t}activities=[];subscription=new be;ngOnInit(){this.subscription.add(this.dashboardService.getActivities().subscribe(t=>{this.activities=t}))}ngOnDestroy(){this.subscription.unsubscribe()}getActivityIcon(t){switch(t){case"config":return"settings";case"monitor":return"monitor";case"alert":return"warning";case"system":return"computer";case"maintenance":return"build";default:return"info"}}getActivityTypeLabel(t){switch(t){case"config":return"Configuraci\xF3n";case"monitor":return"Monitoreo";case"alert":return"Alerta";case"system":return"Sistema";case"maintenance":return"Mantenimiento";default:return t}}getActivityTypeTooltip(t){switch(t){case"config":return"Cambios en la configuraci\xF3n del sistema";case"monitor":return"Eventos de monitoreo de red";case"alert":return"Alertas y notificaciones";case"system":return"Eventos del sistema";case"maintenance":return"Actividades de mantenimiento";default:return""}}getCompletionStatusLabel(t){switch(t){case"pending":return"Pendiente";case"in-progress":return"En progreso";case"completed":return"Completado";case"cancelled":return"Cancelado";default:return t}}refreshActivities(){this.dashboardService.refreshActivities().subscribe(t=>{this.activities=t})}static \u0275fac=function(e){return new(e||r)(S(de))};static \u0275cmp=y({type:r,selectors:[["app-recent-activities"]],decls:11,vars:2,consts:[[1,"activities-container"],[1,"activities-header"],["mat-button","","color","primary",3,"click"],[1,"activities-list"],["class","activity-item",4,"ngFor","ngForOf"],["class","no-activities",4,"ngIf"],[1,"activity-item"],[1,"activity-icon",3,"ngClass"],[1,"activity-content"],[1,"activity-header"],[1,"activity-action"],[1,"activity-time"],[1,"activity-details"],[1,"activity-user"],[1,"activity-type",3,"matTooltip"],["class","activity-description",4,"ngIf"],["class","activity-info",4,"ngIf"],[1,"activity-description"],[1,"activity-info"],["class","info-item",4,"ngIf"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["class","info-type",4,"ngIf"],[1,"info-type"],[1,"no-activities"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"h3"),a(3,"Actividades Recientes"),o(),i(4,"button",2),p("click",function(){return n.refreshActivities()}),i(5,"mat-icon"),a(6,"refresh"),o(),a(7," Actualizar "),o()(),i(8,"div",3),f(9,Or,18,12,"div",4),o(),f(10,Nr,5,0,"div",5),o()),e&2&&(l(9),c("ngForOf",n.activities),l(),c("ngIf",n.activities.length===0))},dependencies:[C,V,H,D,Se,N,M,w,O,F,le,R,L],styles:[".activities-container[_ngcontent-%COMP%]{padding:16px}.activities-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.activities-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.activities-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.activity-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px;background-color:#f5f5f5;border-radius:8px}.activity-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%}.activity-icon.config[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.activity-icon.monitor[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.activity-icon.alert[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.activity-icon.system[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.activity-icon.maintenance[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}.activity-content[_ngcontent-%COMP%]{flex:1}.activity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.activity-action[_ngcontent-%COMP%]{font-weight:500}.activity-time[_ngcontent-%COMP%]{font-size:12px;color:#757575}.activity-details[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:12px;color:#757575;margin-bottom:4px}.activity-description[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;color:#424242}.activity-info[_ngcontent-%COMP%]{margin-top:8px;padding-top:8px;border-top:1px solid #e0e0e0}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:4px;font-size:12px}.info-label[_ngcontent-%COMP%]{color:#757575}.info-value[_ngcontent-%COMP%]{font-weight:500}.info-type[_ngcontent-%COMP%]{color:#757575;font-size:11px}.no-activities[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:32px;color:#757575;text-align:center}.no-activities[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}@media (max-width: 600px){.activity-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.activity-details[_ngcontent-%COMP%]{flex-direction:column;gap:4px}}"]})};function Ar(r,t){if(r&1&&(i(0,"div",18)(1,"span",19),a(2,"Longitud de onda:"),o(),i(3,"span",20),a(4),o()()),r&2){let e=m(2).$implicit;l(4),x("",e.wavelength," nm")}}function Pr(r,t){if(r&1&&(i(0,"div",18)(1,"span",19),a(2,"Nivel de potencia:"),o(),i(3,"span",20),a(4),o()()),r&2){let e=m(2).$implicit;l(4),x("",e.powerLevel," dBm")}}function Rr(r,t){if(r&1&&(i(0,"div",18)(1,"span",19),a(2,"Atenuaci\xF3n:"),o(),i(3,"span",20),a(4),o()()),r&2){let e=m(2).$implicit;l(4),x("",e.attenuation," dB/km")}}function Fr(r,t){if(r&1&&(i(0,"div",18)(1,"span",19),a(2,"Calidad de se\xF1al:"),o(),i(3,"span",20),a(4),o()()),r&2){let e=m(2).$implicit;l(4),x("",e.signalQuality,"%")}}function Lr(r,t){if(r&1&&(i(0,"div",18)(1,"span",19),a(2,"BER:"),o(),i(3,"span",20),a(4),k(5,"number"),o()()),r&2){let e=m(2).$implicit;l(4),g(Y(5,1,e.bitErrorRate,"1.0-9"))}}function $r(r,t){if(r&1&&(i(0,"div",16),f(1,Ar,5,1,"div",17)(2,Pr,5,1,"div",17)(3,Rr,5,1,"div",17)(4,Fr,5,1,"div",17)(5,Lr,6,4,"div",17),o()),r&2){let e=m().$implicit;l(),c("ngIf",e.wavelength),l(),c("ngIf",e.powerLevel),l(),c("ngIf",e.attenuation),l(),c("ngIf",e.signalQuality),l(),c("ngIf",e.bitErrorRate)}}function zr(r,t){if(r&1&&(i(0,"div",21)(1,"mat-icon"),a(2,"location_on"),o(),i(3,"span"),a(4),o()()),r&2){let e=m().$implicit;l(4),g(e.location)}}function Vr(r,t){if(r&1&&(i(0,"div",6)(1,"div",7)(2,"mat-icon",8),a(3),o(),i(4,"span"),a(5),o()(),i(6,"div",9),a(7),o(),_(8,"mat-progress-bar",10),i(9,"div",11)(10,"span",12)(11,"mat-icon"),a(12),o(),a(13),o(),i(14,"span",13),a(15,"vs. hora anterior"),o()(),f(16,$r,6,5,"div",14)(17,zr,5,1,"div",15),o()),r&2){let e=t.$implicit,n=m();l(2),c("color",n.getMetricColor(e.status)),l(),g(n.getMetricIcon(e.type)),l(2),g(e.name),l(2),yt("",e.value,"",n.getMetricUnit(e.type),""),l(),c("mode","determinate")("value",n.getProgressValue(e))("color",n.getMetricColor(e.status)),l(2),c("ngClass",n.getTrendClass(e.trend)),l(2),g(n.getTrendIcon(e.trend)),l(),yt(" ",e.trend,"",n.getMetricUnit(e.type)," "),l(3),c("ngIf",e.wavelength||e.powerLevel||e.attenuation),l(),c("ngIf",e.location)}}function Hr(r,t){r&1&&(i(0,"div",22)(1,"mat-icon"),a(2,"assessment"),o(),i(3,"p"),a(4,"No hay m\xE9tricas disponibles"),o()())}var ut=class r{constructor(t){this.dashboardService=t}metrics=[];subscription=new be;ngOnInit(){this.subscription.add(this.dashboardService.getMetrics().subscribe(t=>{this.metrics=t}))}ngOnDestroy(){this.subscription.unsubscribe()}refreshMetrics(){this.dashboardService.refreshMetrics().subscribe(t=>{this.metrics=t})}getMetricIcon(t){switch(t){case"optical_power":return"power";case"attenuation":return"trending_down";case"signal_strength":return"signal_cellular_alt";case"bandwidth":return"speed";case"latency":return"timer";case"packet_loss":return"error_outline";case"error_rate":return"warning";case"signal_quality":return"network_check";default:return"assessment"}}getMetricUnit(t){switch(t){case"optical_power":return"dBm";case"attenuation":return"dB/km";case"signal_strength":return"dBm";case"bandwidth":return"Mbps";case"latency":return"ms";case"packet_loss":return"%";case"error_rate":return"%";case"signal_quality":return"%";default:return""}}getMetricColor(t){switch(t){case"ACTIVE":return"primary";case"WARNING":return"accent";case"FAULT":return"warn";case"MAINTENANCE":return"accent";case"INACTIVE":case"PLANNED":case"UNKNOWN":default:return"primary"}}getProgressValue(t){switch(t.type){case"optical_power":return Math.min(100,Math.max(0,(t.value+30)/20*100));case"attenuation":return Math.min(100,Math.max(0,(1-t.value)*100));case"bandwidth":return Math.min(100,t.value/1e3*100);case"latency":return Math.min(100,Math.max(0,(1-t.value/100)*100));case"packet_loss":return Math.min(100,Math.max(0,(1-t.value/5)*100));case"signal_quality":return t.value;default:return 50}}getTrendIcon(t){return t>0?"trending_up":t<0?"trending_down":"trending_flat"}getTrendClass(t){return t>0?"positive":t<0?"negative":"neutral"}static \u0275fac=function(e){return new(e||r)(S(de))};static \u0275cmp=y({type:r,selectors:[["app-performance-metrics"]],decls:11,vars:2,consts:[[1,"metrics-container"],[1,"metrics-header"],["mat-button","","color","primary",3,"click"],[1,"metrics-grid"],["class","metric-item",4,"ngFor","ngForOf"],["class","no-metrics",4,"ngIf"],[1,"metric-item"],[1,"metric-header"],[3,"color"],[1,"metric-value"],[3,"mode","value","color"],[1,"metric-footer"],[1,"trend",3,"ngClass"],[1,"period"],["class","metric-details",4,"ngIf"],["class","metric-location",4,"ngIf"],[1,"metric-details"],["class","detail-item",4,"ngIf"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],[1,"metric-location"],[1,"no-metrics"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"h3"),a(3,"M\xE9tricas de Rendimiento"),o(),i(4,"button",2),p("click",function(){return n.refreshMetrics()}),i(5,"mat-icon"),a(6,"refresh"),o(),a(7," Actualizar "),o()(),i(8,"div",3),f(9,Vr,18,14,"div",4),o(),f(10,Hr,5,0,"div",5),o()),e&2&&(l(9),c("ngForOf",n.metrics),l(),c("ngIf",n.metrics.length===0))},dependencies:[C,V,H,D,ti,N,M,w,ke,Ke,R,O,F],styles:[".metrics-container[_ngcontent-%COMP%]{padding:16px}.metrics-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.metrics-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:500}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.metric-item[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:8px;padding:16px}.metric-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px}.metric-value[_ngcontent-%COMP%]{font-size:24px;font-weight:500;margin-bottom:8px}.metric-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:8px;font-size:14px}.trend[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.trend.positive[_ngcontent-%COMP%]{color:#4caf50}.trend.negative[_ngcontent-%COMP%]{color:#f44336}.trend.neutral[_ngcontent-%COMP%]{color:#9e9e9e}.period[_ngcontent-%COMP%]{color:#757575}.metric-details[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #e0e0e0}.detail-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:4px;font-size:12px}.detail-label[_ngcontent-%COMP%]{color:#757575}.detail-value[_ngcontent-%COMP%]{font-weight:500}.metric-location[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin-top:8px;font-size:12px;color:#757575}.metric-location[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.no-metrics[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:32px;color:#757575;text-align:center}.no-metrics[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}@media (max-width: 600px){.metrics-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};var jr=r=>({compact:r}),Br=r=>({lat:19.78375,lng:r});function Wr(r,t){if(r&1){let e=P();i(0,"div",29)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),a(4,"Personalizar Dashboard"),o(),i(5,"button",30),p("click",function(){h(e);let s=m();return v(s.toggleCustomization())}),i(6,"mat-icon"),a(7,"close"),o()()(),i(8,"mat-card-content")(9,"h4"),a(10,"Mostrar/Ocultar Secciones"),o(),i(11,"div",31)(12,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("statCards"))}),a(13," Estad\xEDsticas "),o(),i(14,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("activities"))}),a(15," Actividades "),o(),i(16,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("perfMetrics"))}),a(17," M\xE9tricas Detalladas "),o(),i(18,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("health"))}),a(19," Salud de Red "),o(),i(20,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("map"))}),a(21," Mapa "),o(),i(22,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("metrics"))}),a(23," M\xE9tricas "),o(),i(24,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("alerts"))}),a(25," Alertas "),o(),i(26,"mat-button-toggle",32),p("change",function(){h(e);let s=m();return v(s.toggleSection("network"))}),a(27," Vista Previa de Red "),o()()()()()}if(r&2){let e=m();l(12),c("checked",!e.hiddenSections.includes("statCards")),l(2),c("checked",!e.hiddenSections.includes("activities")),l(2),c("checked",!e.hiddenSections.includes("perfMetrics")),l(2),c("checked",!e.hiddenSections.includes("health")),l(2),c("checked",!e.hiddenSections.includes("map")),l(2),c("checked",!e.hiddenSections.includes("metrics")),l(2),c("checked",!e.hiddenSections.includes("alerts")),l(2),c("checked",!e.hiddenSections.includes("network"))}}function Gr(r,t){r&1&&(i(0,"div",33),_(1,"mat-spinner",34),i(2,"p"),a(3,"Cargando datos..."),o()())}var rn=class r{constructor(t,e,n,s){this.breakpointObserver=t;this.dashboardFacade=e;this.router=n;this.snackBar=s}subscriptions=new be;isCompactView=!1;isCustomizationEnabled=!1;selectedPeriod="day";hiddenSections=[];isNavigating=!1;get loading$(){return this.dashboardFacade.loading$}ngOnInit(){this.subscriptions.add(this.breakpointObserver.observe([Mt.Handset,Mt.Small]).subscribe(t=>{this.isCompactView=t.matches})),this.dashboardFacade.loadDashboardData(),this.preconfigureNetworkDesignRoute()}preconfigureNetworkDesignRoute(){let t;this.router.config.forEach(e=>{if(e.path===""&&e.component&&e.children){let n=e.children.find(s=>s.path===""&&s.component);n&&n.children&&(t=n.children.find(s=>s.path==="network-design"),t&&(console.log("Encontrada ruta network-design para precarga"),t.data||(t.data={}),t.data=ue(pe({},t.data),{preload:!0,priority:"high"}),!t.component&&!t.loadChildren&&console.warn("La ruta network-design no tiene loadChildren o component configurado correctamente")))}}),t||console.warn("No se encontr\xF3 la ruta network-design para precargar")}ngOnDestroy(){this.subscriptions.unsubscribe()}refreshDashboard(){this.dashboardFacade.refreshAll()}refreshSection(t){this.dashboardFacade.refreshSection(t)}toggleSection(t){let e=this.hiddenSections.indexOf(t);e===-1?this.hiddenSections.push(t):this.hiddenSections.splice(e,1)}changePeriod(t){this.selectedPeriod=t,this.dashboardFacade.setPeriod(t)}toggleCustomization(){this.isCustomizationEnabled=!this.isCustomizationEnabled}exportDashboard(t){this.dashboardFacade.exportDashboard(t)}navegarAMapaCompleto(t){if(this.isNavigating)return;this.isNavigating=!0;let e=document.createElement("iframe");e.style.position="absolute",e.style.width="10px",e.style.height="10px",e.style.opacity="0.01",e.style.zIndex="-1000",e.style.pointerEvents="none";let n=this.snackBar.open("Preparando mapa de red...","",{duration:0,panelClass:["info-snackbar"]});document.body.appendChild(e);let s=setTimeout(()=>{console.log("Timer de seguridad activado, usando navegaci\xF3n directa");try{document.body.removeChild(e)}catch{}let u={};t&&(t.center&&(u.lat=t.center.lat.toFixed(6),u.lng=t.center.lng.toFixed(6)),t.zoom&&(u.zoom=t.zoom)),this.router.navigate(["/network-design/map"],{queryParams:u}).then(()=>this.completarNavegacion(n),()=>{n.dismiss(),this.snackBar.open("No se pudo cargar el mapa, intentando nuevamente en modo b\xE1sico...","",{duration:3e3,panelClass:["warning-snackbar"]}),this.router.navigate(["/network-design"],{queryParams:{mode:"minimal"}}).catch(()=>this.isNavigating=!1)})},6e3),d=u=>{u.data==="map-assets-loaded"&&(clearTimeout(s),window.removeEventListener("message",d),this.procederAMapaReal(e,n,t))};window.addEventListener("message",d);try{e.contentWindow&&(e.contentWindow.location.href="/assets/loading-map.html",setTimeout(()=>{try{e.contentWindow&&(e.contentWindow.location.href="/network-design?preload=true")}catch(u){console.error("Error en precarga iframe:",u)}setTimeout(()=>{this.procederAMapaReal(e,n,t)},1500)},1e3))}catch(u){console.error("Error configurando iframe:",u),clearTimeout(s),document.body.removeChild(e);let I={};t&&t.center&&(I.lat=t.center.lat.toFixed(6),I.lng=t.center.lng.toFixed(6),t.zoom&&(I.zoom=t.zoom)),this.router.navigate(["/network-design/map"],{queryParams:I}).catch(()=>this.isNavigating=!1)}}procederAMapaReal(t,e,n){e.dismiss();let s=this.snackBar.open("Cargando mapa...","",{duration:0,panelClass:["info-snackbar"]});try{document.body.removeChild(t)}catch{}let d={preloaded:"true"};n&&(n.center&&(d.lat=n.center.lat.toFixed(6),d.lng=n.center.lng.toFixed(6)),n.zoom&&(d.zoom=n.zoom)),this.router.navigate(["/network-design/map"],{queryParams:d}).then(()=>{s.dismiss(),this.isNavigating=!1,this.snackBar.open("Mapa cargado correctamente","",{duration:1500,panelClass:["success-snackbar"]})},u=>{console.error("Error en navegaci\xF3n final:",u),s.dismiss(),this.isNavigating=!1,this.snackBar.open("Error al cargar el mapa completo. Cargando versi\xF3n b\xE1sica...","",{duration:3e3,panelClass:["warning-snackbar"]}),this.router.navigate(["/network-design"],{queryParams:{mode:"minimal"}})})}completarNavegacion(t){console.log("Navegaci\xF3n completada"),t&&t.dismiss(),setTimeout(()=>{this.isNavigating=!1},1e3)}onFullMapRequested(t){console.log("[MiniMapWidget] Solicitud de mapa completo:",t)}onMiniMapClicked(t){console.log("[MiniMapWidget] Clic en mini-mapa:",t)}onMiniMapError(t){console.error("[MiniMapWidget] Error:",t)}static \u0275fac=function(e){return new(e||r)(S(oi),S(Oe),S(ii),S(Ci))};static \u0275cmp=y({type:r,selectors:[["app-dashboard-layout"]],decls:213,vars:46,consts:[["dashMenu","matMenu"],["statCardsMenu","matMenu"],["activitiesMenu","matMenu"],["perfMetricsMenu","matMenu"],["healthMenu","matMenu"],["mapMenu","matMenu"],["metricsMenu","matMenu"],["alertsMenu","matMenu"],["networkMenu","matMenu"],[1,"dashboard-container"],[1,"dashboard-header"],[1,"header-left"],[1,"dashboard-period-selector"],[3,"change","value"],["value","day","matTooltip","Mostrar datos del d\xEDa"],["value","week","matTooltip","Mostrar datos de la semana"],["value","month","matTooltip","Mostrar datos del mes"],[1,"header-actions"],["mat-button","","color","primary","matTooltip","Actualizar todos los datos",3,"click"],["mat-button","","matTooltip","M\xE1s opciones",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[3,"isCompact"],[1,"dashboard-section","wide-section"],["mat-icon-button","",1,"section-menu-button",3,"matMenuTriggerFor"],[1,"dashboard-grid",3,"ngClass"],[1,"dashboard-section"],[3,"fullMapRequested","mapClicked","errorOccurred","title","height","zoomLevel","centerCoordinates","showActions","openMapButtonText"],["class","customization-panel",4,"ngIf"],["class","loading-overlay",4,"ngIf"],[1,"customization-panel"],["mat-icon-button","",3,"click"],[1,"section-toggles"],[3,"change","checked"],[1,"loading-overlay"],["diameter","50"]],template:function(e,n){if(e&1){let s=P();i(0,"div",9),k(1,"async"),i(2,"div",10)(3,"div",11)(4,"h1"),a(5,"Dashboard"),o(),i(6,"div",12)(7,"mat-button-toggle-group",13),p("change",function(u){return h(s),v(n.changePeriod(u.value))}),i(8,"mat-button-toggle",14),a(9,"Hoy"),o(),i(10,"mat-button-toggle",15),a(11,"Semana"),o(),i(12,"mat-button-toggle",16),a(13,"Mes"),o()()()(),i(14,"div",17)(15,"button",18),p("click",function(){return h(s),v(n.refreshDashboard())}),i(16,"mat-icon"),a(17,"refresh"),o(),a(18," Actualizar "),o(),i(19,"button",19)(20,"mat-icon"),a(21,"more_vert"),o()(),i(22,"mat-menu",null,0)(24,"button",20),p("click",function(){return h(s),v(n.exportDashboard("pdf"))}),i(25,"mat-icon"),a(26,"picture_as_pdf"),o(),i(27,"span"),a(28,"Exportar como PDF"),o()(),i(29,"button",20),p("click",function(){return h(s),v(n.exportDashboard("excel"))}),i(30,"mat-icon"),a(31,"table_chart"),o(),i(32,"span"),a(33,"Exportar como Excel"),o()(),_(34,"mat-divider"),i(35,"button",20),p("click",function(){return h(s),v(n.toggleCustomization())}),i(36,"mat-icon"),a(37,"dashboard_customize"),o(),i(38,"span"),a(39,"Personalizar dashboard"),o()()()()(),_(40,"app-quick-nav-menu",21),i(41,"mat-card",22)(42,"mat-card-header")(43,"mat-card-title"),a(44,"Estad\xEDsticas Principales"),o(),i(45,"button",23)(46,"mat-icon"),a(47,"more_vert"),o()(),i(48,"mat-menu",null,1)(50,"button",20),p("click",function(){return h(s),v(n.refreshSection("statCards"))}),i(51,"mat-icon"),a(52,"refresh"),o(),i(53,"span"),a(54,"Actualizar"),o()(),i(55,"button",20),p("click",function(){return h(s),v(n.toggleSection("statCards"))}),i(56,"mat-icon"),a(57,"visibility_off"),o(),i(58,"span"),a(59,"Ocultar"),o()()()(),i(60,"mat-card-content"),_(61,"app-stat-cards"),o()(),i(62,"mat-card",22)(63,"mat-card-header")(64,"mat-card-title"),a(65,"Actividades Recientes"),o(),i(66,"button",23)(67,"mat-icon"),a(68,"more_vert"),o()(),i(69,"mat-menu",null,2)(71,"button",20),p("click",function(){return h(s),v(n.refreshSection("activities"))}),i(72,"mat-icon"),a(73,"refresh"),o(),i(74,"span"),a(75,"Actualizar"),o()(),i(76,"button",20),p("click",function(){return h(s),v(n.toggleSection("activities"))}),i(77,"mat-icon"),a(78,"visibility_off"),o(),i(79,"span"),a(80,"Ocultar"),o()()()(),i(81,"mat-card-content"),_(82,"app-recent-activities"),o()(),i(83,"mat-card",22)(84,"mat-card-header")(85,"mat-card-title"),a(86,"M\xE9tricas de Rendimiento Detalladas"),o(),i(87,"button",23)(88,"mat-icon"),a(89,"more_vert"),o()(),i(90,"mat-menu",null,3)(92,"button",20),p("click",function(){return h(s),v(n.refreshSection("perfMetrics"))}),i(93,"mat-icon"),a(94,"refresh"),o(),i(95,"span"),a(96,"Actualizar"),o()(),i(97,"button",20),p("click",function(){return h(s),v(n.toggleSection("perfMetrics"))}),i(98,"mat-icon"),a(99,"visibility_off"),o(),i(100,"span"),a(101,"Ocultar"),o()()()(),i(102,"mat-card-content"),_(103,"app-performance-metrics"),o()(),i(104,"div",24)(105,"mat-card",25)(106,"mat-card-header")(107,"mat-card-title"),a(108,"Salud de la Red"),o(),i(109,"button",23)(110,"mat-icon"),a(111,"more_vert"),o()(),i(112,"mat-menu",null,4)(114,"button",20),p("click",function(){return h(s),v(n.refreshSection("health"))}),i(115,"mat-icon"),a(116,"refresh"),o(),i(117,"span"),a(118,"Actualizar"),o()(),i(119,"button",20),p("click",function(){return h(s),v(n.toggleSection("health"))}),i(120,"mat-icon"),a(121,"visibility_off"),o(),i(122,"span"),a(123,"Ocultar"),o()()()(),i(124,"mat-card-content"),_(125,"app-network-health-widget"),o()(),i(126,"mat-card",25)(127,"mat-card-header")(128,"mat-card-title"),a(129,"Mapa de Red"),o(),i(130,"button",23)(131,"mat-icon"),a(132,"more_vert"),o()(),i(133,"mat-menu",null,5)(135,"button",20),p("click",function(){return h(s),v(n.refreshSection("map"))}),i(136,"mat-icon"),a(137,"refresh"),o(),i(138,"span"),a(139,"Actualizar"),o()(),i(140,"button",20),p("click",function(){return h(s),v(n.toggleSection("map"))}),i(141,"mat-icon"),a(142,"visibility_off"),o(),i(143,"span"),a(144,"Ocultar"),o()()()(),i(145,"mat-card-content")(146,"app-mini-map-widget",26),p("fullMapRequested",function(u){return h(s),v(n.onFullMapRequested(u))})("mapClicked",function(u){return h(s),v(n.onMiniMapClicked(u))})("errorOccurred",function(u){return h(s),v(n.onMiniMapError(u))}),o()()(),i(147,"mat-card",25)(148,"mat-card-header")(149,"mat-card-title"),a(150,"M\xE9tricas de Rendimiento"),o(),i(151,"button",23)(152,"mat-icon"),a(153,"more_vert"),o()(),i(154,"mat-menu",null,6)(156,"button",20),p("click",function(){return h(s),v(n.refreshSection("metrics"))}),i(157,"mat-icon"),a(158,"refresh"),o(),i(159,"span"),a(160,"Actualizar"),o()(),i(161,"button",20),p("click",function(){return h(s),v(n.toggleSection("metrics"))}),i(162,"mat-icon"),a(163,"visibility_off"),o(),i(164,"span"),a(165,"Ocultar"),o()()()(),i(166,"mat-card-content"),_(167,"app-metrics-widget"),o()(),i(168,"mat-card",22)(169,"mat-card-header")(170,"mat-card-title"),a(171,"Alertas del Sistema"),o(),i(172,"button",23)(173,"mat-icon"),a(174,"more_vert"),o()(),i(175,"mat-menu",null,7)(177,"button",20),p("click",function(){return h(s),v(n.refreshSection("alerts"))}),i(178,"mat-icon"),a(179,"refresh"),o(),i(180,"span"),a(181,"Actualizar"),o()(),i(182,"button",20),p("click",function(){return h(s),v(n.toggleSection("alerts"))}),i(183,"mat-icon"),a(184,"visibility_off"),o(),i(185,"span"),a(186,"Ocultar"),o()()()(),i(187,"mat-card-content"),_(188,"app-system-alerts-widget"),o()(),i(189,"mat-card",25)(190,"mat-card-header")(191,"mat-card-title"),a(192,"Vista Previa de Red"),o(),i(193,"button",23)(194,"mat-icon"),a(195,"more_vert"),o()(),i(196,"mat-menu",null,8)(198,"button",20),p("click",function(){return h(s),v(n.refreshSection("network"))}),i(199,"mat-icon"),a(200,"refresh"),o(),i(201,"span"),a(202,"Actualizar"),o()(),i(203,"button",20),p("click",function(){return h(s),v(n.toggleSection("network"))}),i(204,"mat-icon"),a(205,"visibility_off"),o(),i(206,"span"),a(207,"Ocultar"),o()()()(),i(208,"mat-card-content"),_(209,"app-network-widget"),o()()(),f(210,Wr,28,8,"div",27)(211,Gr,4,0,"div",28),k(212,"async"),o()}if(e&2){let s=U(23),d=U(49),u=U(70),I=U(91),ve=U(113),me=U(134),ne=U(155),_e=U(176),Ne=U(197);E("loading",ie(1,38,n.loading$)),l(7),c("value",n.selectedPeriod),l(12),c("matMenuTriggerFor",s),l(21),c("isCompact",n.isCompactView),l(),E("hidden",n.hiddenSections.includes("statCards")),l(4),c("matMenuTriggerFor",d),l(17),E("hidden",n.hiddenSections.includes("activities")),l(4),c("matMenuTriggerFor",u),l(17),E("hidden",n.hiddenSections.includes("perfMetrics")),l(4),c("matMenuTriggerFor",I),l(17),c("ngClass",ge(42,jr,n.isCompactView)),l(),E("hidden",n.hiddenSections.includes("health")),l(4),c("matMenuTriggerFor",ve),l(17),E("hidden",n.hiddenSections.includes("map")),l(4),c("matMenuTriggerFor",me),l(16),c("title","Mini Mapa de Red")("height",200)("zoomLevel",12)("centerCoordinates",ge(44,Br,-70.67667))("showActions",!0)("openMapButtonText","Ver mapa completo"),l(),E("hidden",n.hiddenSections.includes("metrics")),l(4),c("matMenuTriggerFor",ne),l(17),E("hidden",n.hiddenSections.includes("alerts")),l(4),c("matMenuTriggerFor",_e),l(17),E("hidden",n.hiddenSections.includes("network")),l(4),c("matMenuTriggerFor",Ne),l(17),c("ngIf",n.isCustomizationEnabled),l(),c("ngIf",ie(212,40,n.loading$))}},dependencies:[C,V,D,qe,N,Z,X,J,K,Zi,M,w,O,F,Q,pi,di,ci,mi,q,se,si,le,hi,Yi,Gi,Ui,R,L,ae,Xe,tt,it,nt,ct,dt,mt,pt,ut],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px;position:relative;min-height:100vh}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:500;color:#333}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.dashboard-period-selector[_ngcontent-%COMP%]{margin-left:10px}.dashboard-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px}@media (max-width: 960px){.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.dashboard-grid[_ngcontent-%COMP%]{margin-bottom:20px}.dashboard-grid.compact[_ngcontent-%COMP%]{grid-template-columns:1fr}.dashboard-section[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 4px #0000001a;background-color:#fff;overflow:hidden;margin-bottom:16px}.dashboard-section.wide-section[_ngcontent-%COMP%]{grid-column:span 2}@media (max-width: 960px){.dashboard-section.wide-section[_ngcontent-%COMP%]{grid-column:span 1}}.hidden[_ngcontent-%COMP%]{display:none}.section-menu-button[_ngcontent-%COMP%]{position:absolute;right:8px;top:8px}.customization-panel[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1000;width:100%;max-width:500px}.customization-panel[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 4px #0000001a;background-color:#fff;overflow:hidden}.section-toggles[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#ffffffb3;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}app-quick-nav-menu[_ngcontent-%COMP%]{display:block;margin:0 0 20px}"]})};export{rn as a};
